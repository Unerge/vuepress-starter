!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).WatermarkPlus={})}(this,(function(t){"use strict";var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=function(t){return t&&t.Math===Math&&t},r=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof e&&e)||n("object"==typeof e&&e)||function(){return this}()||Function("return this")(),o={},i=function(t){try{return!!t()}catch(t){return!0}},a=!i((function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]})),s=!i((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")})),c=s,l=Function.prototype.call,u=c?l.bind(l):function(){return l.apply(l,arguments)},d={},h={}.propertyIsEnumerable,f=Object.getOwnPropertyDescriptor,p=f&&!h.call({1:2},1);d.f=p?function(t){var e=f(this,t);return!!e&&e.enumerable}:h;var v,y,m=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},g=s,w=Function.prototype,b=w.call,x=g&&w.bind.bind(b,b),S=g?x:function(t){return function(){return b.apply(t,arguments)}},O=S,P=O({}.toString),E=O("".slice),T=function(t){return E(P(t),8,-1)},k=i,C=T,A=Object,j=S("".split),R=k((function(){return!A("z").propertyIsEnumerable(0)}))?function(t){return"String"===C(t)?j(t,""):A(t)}:A,_=function(t){return null==t},L=_,D=TypeError,I=function(t){if(L(t))throw new D("Can't call method on "+t);return t},B=R,H=I,N=function(t){return B(H(t))},W="object"==typeof document&&document.all,U=void 0===W&&void 0!==W?function(t){return"function"==typeof t||t===W}:function(t){return"function"==typeof t},F=U,M=function(t){return"object"==typeof t?null!==t:F(t)},G=r,q=U,z=function(t,e){return arguments.length<2?(n=G[t],q(n)?n:void 0):G[t]&&G[t][e];var n},V=S({}.isPrototypeOf),X=r.navigator,Y=X&&X.userAgent,$=Y?String(Y):"",K=r,J=$,Z=K.process,Q=K.Deno,tt=Z&&Z.versions||Q&&Q.version,et=tt&&tt.v8;et&&(y=(v=et.split("."))[0]>0&&v[0]<4?1:+(v[0]+v[1])),!y&&J&&(!(v=J.match(/Edge\/(\d+)/))||v[1]>=74)&&(v=J.match(/Chrome\/(\d+)/))&&(y=+v[1]);var nt=y,rt=nt,ot=i,it=r.String,at=!!Object.getOwnPropertySymbols&&!ot((function(){var t=Symbol("symbol detection");return!it(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&rt&&rt<41})),st=at&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,ct=z,lt=U,ut=V,dt=Object,ht=st?function(t){return"symbol"==typeof t}:function(t){var e=ct("Symbol");return lt(e)&&ut(e.prototype,dt(t))},ft=String,pt=function(t){try{return ft(t)}catch(t){return"Object"}},vt=U,yt=pt,mt=TypeError,gt=function(t){if(vt(t))return t;throw new mt(yt(t)+" is not a function")},wt=gt,bt=_,xt=function(t,e){var n=t[e];return bt(n)?void 0:wt(n)},St=u,Ot=U,Pt=M,Et=TypeError,Tt={exports:{}},kt=r,Ct=Object.defineProperty,At=function(t,e){try{Ct(kt,t,{value:e,configurable:!0,writable:!0})}catch(n){kt[t]=e}return e},jt=r,Rt=At,_t="__core-js_shared__",Lt=Tt.exports=jt[_t]||Rt(_t,{});(Lt.versions||(Lt.versions=[])).push({version:"3.38.1",mode:"global",copyright:"Â© 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.38.1/LICENSE",source:"https://github.com/zloirock/core-js"});var Dt=Tt.exports,It=Dt,Bt=function(t,e){return It[t]||(It[t]=e||{})},Ht=I,Nt=Object,Wt=function(t){return Nt(Ht(t))},Ut=Wt,Ft=S({}.hasOwnProperty),Mt=Object.hasOwn||function(t,e){return Ft(Ut(t),e)},Gt=S,qt=0,zt=Math.random(),Vt=Gt(1..toString),Xt=function(t){return"Symbol("+(void 0===t?"":t)+")_"+Vt(++qt+zt,36)},Yt=Bt,$t=Mt,Kt=Xt,Jt=at,Zt=st,Qt=r.Symbol,te=Yt("wks"),ee=Zt?Qt.for||Qt:Qt&&Qt.withoutSetter||Kt,ne=function(t){return $t(te,t)||(te[t]=Jt&&$t(Qt,t)?Qt[t]:ee("Symbol."+t)),te[t]},re=u,oe=M,ie=ht,ae=xt,se=function(t,e){var n,r;if("string"===e&&Ot(n=t.toString)&&!Pt(r=St(n,t)))return r;if(Ot(n=t.valueOf)&&!Pt(r=St(n,t)))return r;if("string"!==e&&Ot(n=t.toString)&&!Pt(r=St(n,t)))return r;throw new Et("Can't convert object to primitive value")},ce=TypeError,le=ne("toPrimitive"),ue=function(t,e){if(!oe(t)||ie(t))return t;var n,r=ae(t,le);if(r){if(void 0===e&&(e="default"),n=re(r,t,e),!oe(n)||ie(n))return n;throw new ce("Can't convert object to primitive value")}return void 0===e&&(e="number"),se(t,e)},de=ht,he=function(t){var e=ue(t,"string");return de(e)?e:e+""},fe=M,pe=r.document,ve=fe(pe)&&fe(pe.createElement),ye=function(t){return ve?pe.createElement(t):{}},me=ye,ge=!a&&!i((function(){return 7!==Object.defineProperty(me("div"),"a",{get:function(){return 7}}).a})),we=a,be=u,xe=d,Se=m,Oe=N,Pe=he,Ee=Mt,Te=ge,ke=Object.getOwnPropertyDescriptor;o.f=we?ke:function(t,e){if(t=Oe(t),e=Pe(e),Te)try{return ke(t,e)}catch(t){}if(Ee(t,e))return Se(!be(xe.f,t,e),t[e])};var Ce={},Ae=a&&i((function(){return 42!==Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),je=M,Re=String,_e=TypeError,Le=function(t){if(je(t))return t;throw new _e(Re(t)+" is not an object")},De=a,Ie=ge,Be=Ae,He=Le,Ne=he,We=TypeError,Ue=Object.defineProperty,Fe=Object.getOwnPropertyDescriptor,Me="enumerable",Ge="configurable",qe="writable";Ce.f=De?Be?function(t,e,n){if(He(t),e=Ne(e),He(n),"function"==typeof t&&"prototype"===e&&"value"in n&&qe in n&&!n[qe]){var r=Fe(t,e);r&&r[qe]&&(t[e]=n.value,n={configurable:Ge in n?n[Ge]:r[Ge],enumerable:Me in n?n[Me]:r[Me],writable:!1})}return Ue(t,e,n)}:Ue:function(t,e,n){if(He(t),e=Ne(e),He(n),Ie)try{return Ue(t,e,n)}catch(t){}if("get"in n||"set"in n)throw new We("Accessors not supported");return"value"in n&&(t[e]=n.value),t};var ze=Ce,Ve=m,Xe=a?function(t,e,n){return ze.f(t,e,Ve(1,n))}:function(t,e,n){return t[e]=n,t},Ye={exports:{}},$e=a,Ke=Mt,Je=Function.prototype,Ze=$e&&Object.getOwnPropertyDescriptor,Qe=Ke(Je,"name"),tn={EXISTS:Qe,PROPER:Qe&&"something"===function(){}.name,CONFIGURABLE:Qe&&(!$e||$e&&Ze(Je,"name").configurable)},en=U,nn=Dt,rn=S(Function.toString);en(nn.inspectSource)||(nn.inspectSource=function(t){return rn(t)});var on,an,sn,cn=nn.inspectSource,ln=U,un=r.WeakMap,dn=ln(un)&&/native code/.test(String(un)),hn=Xt,fn=Bt("keys"),pn=function(t){return fn[t]||(fn[t]=hn(t))},vn={},yn=dn,mn=r,gn=M,wn=Xe,bn=Mt,xn=Dt,Sn=pn,On=vn,Pn="Object already initialized",En=mn.TypeError,Tn=mn.WeakMap;if(yn||xn.state){var kn=xn.state||(xn.state=new Tn);kn.get=kn.get,kn.has=kn.has,kn.set=kn.set,on=function(t,e){if(kn.has(t))throw new En(Pn);return e.facade=t,kn.set(t,e),e},an=function(t){return kn.get(t)||{}},sn=function(t){return kn.has(t)}}else{var Cn=Sn("state");On[Cn]=!0,on=function(t,e){if(bn(t,Cn))throw new En(Pn);return e.facade=t,wn(t,Cn,e),e},an=function(t){return bn(t,Cn)?t[Cn]:{}},sn=function(t){return bn(t,Cn)}}var An={set:on,get:an,has:sn,enforce:function(t){return sn(t)?an(t):on(t,{})},getterFor:function(t){return function(e){var n;if(!gn(e)||(n=an(e)).type!==t)throw new En("Incompatible receiver, "+t+" required");return n}}},jn=S,Rn=i,_n=U,Ln=Mt,Dn=a,In=tn.CONFIGURABLE,Bn=cn,Hn=An.enforce,Nn=An.get,Wn=String,Un=Object.defineProperty,Fn=jn("".slice),Mn=jn("".replace),Gn=jn([].join),qn=Dn&&!Rn((function(){return 8!==Un((function(){}),"length",{value:8}).length})),zn=String(String).split("String"),Vn=Ye.exports=function(t,e,n){"Symbol("===Fn(Wn(e),0,7)&&(e="["+Mn(Wn(e),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!Ln(t,"name")||In&&t.name!==e)&&(Dn?Un(t,"name",{value:e,configurable:!0}):t.name=e),qn&&n&&Ln(n,"arity")&&t.length!==n.arity&&Un(t,"length",{value:n.arity});try{n&&Ln(n,"constructor")&&n.constructor?Dn&&Un(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(t){}var r=Hn(t);return Ln(r,"source")||(r.source=Gn(zn,"string"==typeof e?e:"")),t};Function.prototype.toString=Vn((function(){return _n(this)&&Nn(this).source||Bn(this)}),"toString");var Xn=Ye.exports,Yn=U,$n=Ce,Kn=Xn,Jn=At,Zn=function(t,e,n,r){r||(r={});var o=r.enumerable,i=void 0!==r.name?r.name:e;if(Yn(n)&&Kn(n,i,r),r.global)o?t[e]=n:Jn(e,n);else{try{r.unsafe?t[e]&&(o=!0):delete t[e]}catch(t){}o?t[e]=n:$n.f(t,e,{value:n,enumerable:!1,configurable:!r.nonConfigurable,writable:!r.nonWritable})}return t},Qn={},tr=Math.ceil,er=Math.floor,nr=Math.trunc||function(t){var e=+t;return(e>0?er:tr)(e)},rr=function(t){var e=+t;return e!=e||0===e?0:nr(e)},or=rr,ir=Math.max,ar=Math.min,sr=function(t,e){var n=or(t);return n<0?ir(n+e,0):ar(n,e)},cr=rr,lr=Math.min,ur=function(t){var e=cr(t);return e>0?lr(e,9007199254740991):0},dr=function(t){return ur(t.length)},hr=N,fr=sr,pr=dr,vr=function(t){return function(e,n,r){var o=hr(e),i=pr(o);if(0===i)return!t&&-1;var a,s=fr(r,i);if(t&&n!=n){for(;i>s;)if((a=o[s++])!=a)return!0}else for(;i>s;s++)if((t||s in o)&&o[s]===n)return t||s||0;return!t&&-1}},yr={includes:vr(!0),indexOf:vr(!1)},mr=Mt,gr=N,wr=yr.indexOf,br=vn,xr=S([].push),Sr=function(t,e){var n,r=gr(t),o=0,i=[];for(n in r)!mr(br,n)&&mr(r,n)&&xr(i,n);for(;e.length>o;)mr(r,n=e[o++])&&(~wr(i,n)||xr(i,n));return i},Or=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Pr=Sr,Er=Or.concat("length","prototype");Qn.f=Object.getOwnPropertyNames||function(t){return Pr(t,Er)};var Tr={};Tr.f=Object.getOwnPropertySymbols;var kr=z,Cr=Qn,Ar=Tr,jr=Le,Rr=S([].concat),_r=kr("Reflect","ownKeys")||function(t){var e=Cr.f(jr(t)),n=Ar.f;return n?Rr(e,n(t)):e},Lr=Mt,Dr=_r,Ir=o,Br=Ce,Hr=i,Nr=U,Wr=/#|\.prototype\./,Ur=function(t,e){var n=Mr[Fr(t)];return n===qr||n!==Gr&&(Nr(e)?Hr(e):!!e)},Fr=Ur.normalize=function(t){return String(t).replace(Wr,".").toLowerCase()},Mr=Ur.data={},Gr=Ur.NATIVE="N",qr=Ur.POLYFILL="P",zr=Ur,Vr=r,Xr=o.f,Yr=Xe,$r=Zn,Kr=At,Jr=function(t,e,n){for(var r=Dr(e),o=Br.f,i=Ir.f,a=0;a<r.length;a++){var s=r[a];Lr(t,s)||n&&Lr(n,s)||o(t,s,i(e,s))}},Zr=zr,Qr=function(t,e){var n,r,o,i,a,s=t.target,c=t.global,l=t.stat;if(n=c?Vr:l?Vr[s]||Kr(s,{}):Vr[s]&&Vr[s].prototype)for(r in e){if(i=e[r],o=t.dontCallGetSet?(a=Xr(n,r))&&a.value:n[r],!Zr(c?r:s+(l?".":"#")+r,t.forced)&&void 0!==o){if(typeof i==typeof o)continue;Jr(i,o)}(t.sham||o&&o.sham)&&Yr(i,"sham",!0),$r(n,r,i,t)}},to=T,eo=S,no=function(t){if("Function"===to(t))return eo(t)},ro=gt,oo=s,io=no(no.bind),ao=function(t,e){return ro(t),void 0===e?t:oo?io(t,e):function(){return t.apply(e,arguments)}},so=u,co=Le,lo=xt,uo=function(t,e,n){var r,o;co(t);try{if(!(r=lo(t,"return"))){if("throw"===e)throw n;return n}r=so(r,t)}catch(t){o=!0,r=t}if("throw"===e)throw n;if(o)throw r;return co(r),n},ho=Le,fo=uo,po={},vo=po,yo=ne("iterator"),mo=Array.prototype,go=function(t){return void 0!==t&&(vo.Array===t||mo[yo]===t)},wo={};wo[ne("toStringTag")]="z";var bo="[object z]"===String(wo),xo=U,So=T,Oo=ne("toStringTag"),Po=Object,Eo="Arguments"===So(function(){return arguments}()),To=bo?So:function(t){var e,n,r;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Po(t),Oo))?n:Eo?So(e):"Object"===(r=So(e))&&xo(e.callee)?"Arguments":r},ko=S,Co=i,Ao=U,jo=To,Ro=cn,_o=function(){},Lo=z("Reflect","construct"),Do=/^\s*(?:class|function)\b/,Io=ko(Do.exec),Bo=!Do.test(_o),Ho=function(t){if(!Ao(t))return!1;try{return Lo(_o,[],t),!0}catch(t){return!1}},No=function(t){if(!Ao(t))return!1;switch(jo(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return Bo||!!Io(Do,Ro(t))}catch(t){return!0}};No.sham=!0;var Wo=!Lo||Co((function(){var t;return Ho(Ho.call)||!Ho(Object)||!Ho((function(){t=!0}))||t}))?No:Ho,Uo=a,Fo=Ce,Mo=m,Go=To,qo=xt,zo=_,Vo=po,Xo=ne("iterator"),Yo=function(t){if(!zo(t))return qo(t,Xo)||qo(t,"@@iterator")||Vo[Go(t)]},$o=u,Ko=gt,Jo=Le,Zo=pt,Qo=Yo,ti=TypeError,ei=function(t,e){var n=arguments.length<2?Qo(t):e;if(Ko(n))return Jo($o(n,t));throw new ti(Zo(t)+" is not iterable")},ni=ao,ri=u,oi=Wt,ii=function(t,e,n,r){try{return r?e(ho(n)[0],n[1]):e(n)}catch(e){fo(t,"throw",e)}},ai=go,si=Wo,ci=dr,li=function(t,e,n){Uo?Fo.f(t,e,Mo(0,n)):t[e]=n},ui=ei,di=Yo,hi=Array,fi=ne("iterator"),pi=!1;try{var vi=0,yi={next:function(){return{done:!!vi++}},return:function(){pi=!0}};yi[fi]=function(){return this},Array.from(yi,(function(){throw 2}))}catch(t){}var mi=function(t,e){try{if(!e&&!pi)return!1}catch(t){return!1}var n=!1;try{var r={};r[fi]=function(){return{next:function(){return{done:n=!0}}}},t(r)}catch(t){}return n},gi=function(t){var e=oi(t),n=si(this),r=arguments.length,o=r>1?arguments[1]:void 0,i=void 0!==o;i&&(o=ni(o,r>2?arguments[2]:void 0));var a,s,c,l,u,d,h=di(e),f=0;if(!h||this===hi&&ai(h))for(a=ci(e),s=n?new this(a):hi(a);a>f;f++)d=i?o(e[f],f):e[f],li(s,f,d);else for(s=n?new this:[],u=(l=ui(e,h)).next;!(c=ri(u,l)).done;f++)d=i?ii(l,o,[c.value,f],!0):c.value,li(s,f,d);return s.length=f,s};Qr({target:"Array",stat:!0,forced:!mi((function(t){Array.from(t)}))},{from:gi});var wi,bi,xi,Si,Oi=r,Pi=$,Ei=T,Ti=function(t){return Pi.slice(0,t.length)===t},ki=Ti("Bun/")?"BUN":Ti("Cloudflare-Workers")?"CLOUDFLARE":Ti("Deno/")?"DENO":Ti("Node.js/")?"NODE":Oi.Bun&&"string"==typeof Bun.version?"BUN":Oi.Deno&&"object"==typeof Deno.version?"DENO":"process"===Ei(Oi.process)?"NODE":Oi.window&&Oi.document?"BROWSER":"REST",Ci="NODE"===ki,Ai=S,ji=gt,Ri=M,_i=function(t){return Ri(t)||null===t},Li=String,Di=TypeError,Ii=function(t,e,n){try{return Ai(ji(Object.getOwnPropertyDescriptor(t,e)[n]))}catch(t){}},Bi=M,Hi=I,Ni=function(t){if(_i(t))return t;throw new Di("Can't set "+Li(t)+" as a prototype")},Wi=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,n={};try{(t=Ii(Object.prototype,"__proto__","set"))(n,[]),e=n instanceof Array}catch(t){}return function(n,r){return Hi(n),Ni(r),Bi(n)?(e?t(n,r):n.__proto__=r,n):n}}():void 0),Ui=Ce.f,Fi=Mt,Mi=ne("toStringTag"),Gi=Xn,qi=Ce,zi=z,Vi=function(t,e,n){return n.get&&Gi(n.get,e,{getter:!0}),n.set&&Gi(n.set,e,{setter:!0}),qi.f(t,e,n)},Xi=a,Yi=ne("species"),$i=V,Ki=TypeError,Ji=Wo,Zi=pt,Qi=TypeError,ta=Le,ea=function(t){if(Ji(t))return t;throw new Qi(Zi(t)+" is not a constructor")},na=_,ra=ne("species"),oa=s,ia=Function.prototype,aa=ia.apply,sa=ia.call,ca="object"==typeof Reflect&&Reflect.apply||(oa?sa.bind(aa):function(){return sa.apply(aa,arguments)}),la=z("document","documentElement"),ua=S([].slice),da=TypeError,ha=/(?:ipad|iphone|ipod).*applewebkit/i.test($),fa=r,pa=ca,va=ao,ya=U,ma=Mt,ga=i,wa=la,ba=ua,xa=ye,Sa=function(t,e){if(t<e)throw new da("Not enough arguments");return t},Oa=ha,Pa=Ci,Ea=fa.setImmediate,Ta=fa.clearImmediate,ka=fa.process,Ca=fa.Dispatch,Aa=fa.Function,ja=fa.MessageChannel,Ra=fa.String,_a=0,La={},Da="onreadystatechange";ga((function(){wi=fa.location}));var Ia=function(t){if(ma(La,t)){var e=La[t];delete La[t],e()}},Ba=function(t){return function(){Ia(t)}},Ha=function(t){Ia(t.data)},Na=function(t){fa.postMessage(Ra(t),wi.protocol+"//"+wi.host)};Ea&&Ta||(Ea=function(t){Sa(arguments.length,1);var e=ya(t)?t:Aa(t),n=ba(arguments,1);return La[++_a]=function(){pa(e,void 0,n)},bi(_a),_a},Ta=function(t){delete La[t]},Pa?bi=function(t){ka.nextTick(Ba(t))}:Ca&&Ca.now?bi=function(t){Ca.now(Ba(t))}:ja&&!Oa?(Si=(xi=new ja).port2,xi.port1.onmessage=Ha,bi=va(Si.postMessage,Si)):fa.addEventListener&&ya(fa.postMessage)&&!fa.importScripts&&wi&&"file:"!==wi.protocol&&!ga(Na)?(bi=Na,fa.addEventListener("message",Ha,!1)):bi=Da in xa("script")?function(t){wa.appendChild(xa("script"))[Da]=function(){wa.removeChild(this),Ia(t)}}:function(t){setTimeout(Ba(t),0)});var Wa={set:Ea,clear:Ta},Ua=r,Fa=a,Ma=Object.getOwnPropertyDescriptor,Ga=function(){this.head=null,this.tail=null};Ga.prototype={add:function(t){var e={item:t,next:null},n=this.tail;n?n.next=e:this.head=e,this.tail=e},get:function(){var t=this.head;if(t)return null===(this.head=t.next)&&(this.tail=null),t.item}};var qa,za,Va,Xa,Ya,$a=Ga,Ka=/ipad|iphone|ipod/i.test($)&&"undefined"!=typeof Pebble,Ja=/web0s(?!.*chrome)/i.test($),Za=r,Qa=function(t){if(!Fa)return Ua[t];var e=Ma(Ua,t);return e&&e.value},ts=ao,es=Wa.set,ns=$a,rs=ha,os=Ka,is=Ja,as=Ci,ss=Za.MutationObserver||Za.WebKitMutationObserver,cs=Za.document,ls=Za.process,us=Za.Promise,ds=Qa("queueMicrotask");if(!ds){var hs=new ns,fs=function(){var t,e;for(as&&(t=ls.domain)&&t.exit();e=hs.get();)try{e()}catch(t){throw hs.head&&qa(),t}t&&t.enter()};rs||as||is||!ss||!cs?!os&&us&&us.resolve?((Xa=us.resolve(void 0)).constructor=us,Ya=ts(Xa.then,Xa),qa=function(){Ya(fs)}):as?qa=function(){ls.nextTick(fs)}:(es=ts(es,Za),qa=function(){es(fs)}):(za=!0,Va=cs.createTextNode(""),new ss(fs).observe(Va,{characterData:!0}),qa=function(){Va.data=za=!za}),ds=function(t){hs.head||qa(),hs.add(t)}}var ps=ds,vs=function(t){try{return{error:!1,value:t()}}catch(t){return{error:!0,value:t}}},ys=r.Promise,ms=r,gs=ys,ws=U,bs=zr,xs=cn,Ss=ne,Os=ki,Ps=nt;gs&&gs.prototype;var Es=Ss("species"),Ts=!1,ks=ws(ms.PromiseRejectionEvent),Cs=bs("Promise",(function(){var t=xs(gs),e=t!==String(gs);if(!e&&66===Ps)return!0;if(!Ps||Ps<51||!/native code/.test(t)){var n=new gs((function(t){t(1)})),r=function(t){t((function(){}),(function(){}))};if((n.constructor={})[Es]=r,!(Ts=n.then((function(){}))instanceof r))return!0}return!(e||"BROWSER"!==Os&&"DENO"!==Os||ks)})),As={CONSTRUCTOR:Cs,REJECTION_EVENT:ks,SUBCLASSING:Ts},js={},Rs=gt,_s=TypeError,Ls=function(t){var e,n;this.promise=new t((function(t,r){if(void 0!==e||void 0!==n)throw new _s("Bad Promise constructor");e=t,n=r})),this.resolve=Rs(e),this.reject=Rs(n)};js.f=function(t){return new Ls(t)};var Ds,Is,Bs,Hs=Qr,Ns=Ci,Ws=r,Us=u,Fs=Zn,Ms=Wi,Gs=function(t,e,n){t&&!n&&(t=t.prototype),t&&!Fi(t,Mi)&&Ui(t,Mi,{configurable:!0,value:e})},qs=function(t){var e=zi(t);Xi&&e&&!e[Yi]&&Vi(e,Yi,{configurable:!0,get:function(){return this}})},zs=gt,Vs=U,Xs=M,Ys=function(t,e){if($i(e,t))return t;throw new Ki("Incorrect invocation")},$s=function(t,e){var n,r=ta(t).constructor;return void 0===r||na(n=ta(r)[ra])?e:ea(n)},Ks=Wa.set,Js=ps,Zs=function(t,e){},Qs=vs,tc=$a,ec=An,nc=ys,rc=js,oc="Promise",ic=As.CONSTRUCTOR,ac=As.REJECTION_EVENT,sc=As.SUBCLASSING,cc=ec.getterFor(oc),lc=ec.set,uc=nc&&nc.prototype,dc=nc,hc=uc,fc=Ws.TypeError,pc=Ws.document,vc=Ws.process,yc=rc.f,mc=yc,gc=!!(pc&&pc.createEvent&&Ws.dispatchEvent),wc="unhandledrejection",bc=function(t){var e;return!(!Xs(t)||!Vs(e=t.then))&&e},xc=function(t,e){var n,r,o,i=e.value,a=1===e.state,s=a?t.ok:t.fail,c=t.resolve,l=t.reject,u=t.domain;try{s?(a||(2===e.rejection&&Tc(e),e.rejection=1),!0===s?n=i:(u&&u.enter(),n=s(i),u&&(u.exit(),o=!0)),n===t.promise?l(new fc("Promise-chain cycle")):(r=bc(n))?Us(r,n,c,l):c(n)):l(i)}catch(t){u&&!o&&u.exit(),l(t)}},Sc=function(t,e){t.notified||(t.notified=!0,Js((function(){for(var n,r=t.reactions;n=r.get();)xc(n,t);t.notified=!1,e&&!t.rejection&&Pc(t)})))},Oc=function(t,e,n){var r,o;gc?((r=pc.createEvent("Event")).promise=e,r.reason=n,r.initEvent(t,!1,!0),Ws.dispatchEvent(r)):r={promise:e,reason:n},!ac&&(o=Ws["on"+t])?o(r):t===wc&&Zs("Unhandled promise rejection",n)},Pc=function(t){Us(Ks,Ws,(function(){var e,n=t.facade,r=t.value;if(Ec(t)&&(e=Qs((function(){Ns?vc.emit("unhandledRejection",r,n):Oc(wc,n,r)})),t.rejection=Ns||Ec(t)?2:1,e.error))throw e.value}))},Ec=function(t){return 1!==t.rejection&&!t.parent},Tc=function(t){Us(Ks,Ws,(function(){var e=t.facade;Ns?vc.emit("rejectionHandled",e):Oc("rejectionhandled",e,t.value)}))},kc=function(t,e,n){return function(r){t(e,r,n)}},Cc=function(t,e,n){t.done||(t.done=!0,n&&(t=n),t.value=e,t.state=2,Sc(t,!0))},Ac=function(t,e,n){if(!t.done){t.done=!0,n&&(t=n);try{if(t.facade===e)throw new fc("Promise can't be resolved itself");var r=bc(e);r?Js((function(){var n={done:!1};try{Us(r,e,kc(Ac,n,t),kc(Cc,n,t))}catch(e){Cc(n,e,t)}})):(t.value=e,t.state=1,Sc(t,!1))}catch(e){Cc({done:!1},e,t)}}};if(ic&&(hc=(dc=function(t){Ys(this,hc),zs(t),Us(Ds,this);var e=cc(this);try{t(kc(Ac,e),kc(Cc,e))}catch(t){Cc(e,t)}}).prototype,(Ds=function(t){lc(this,{type:oc,done:!1,notified:!1,parent:!1,reactions:new tc,rejection:!1,state:0,value:null})}).prototype=Fs(hc,"then",(function(t,e){var n=cc(this),r=yc($s(this,dc));return n.parent=!0,r.ok=!Vs(t)||t,r.fail=Vs(e)&&e,r.domain=Ns?vc.domain:void 0,0===n.state?n.reactions.add(r):Js((function(){xc(r,n)})),r.promise})),Is=function(){var t=new Ds,e=cc(t);this.promise=t,this.resolve=kc(Ac,e),this.reject=kc(Cc,e)},rc.f=yc=function(t){return t===dc||undefined===t?new Is(t):mc(t)},Vs(nc)&&uc!==Object.prototype)){Bs=uc.then,sc||Fs(uc,"then",(function(t,e){var n=this;return new dc((function(t,e){Us(Bs,n,t,e)})).then(t,e)}),{unsafe:!0});try{delete uc.constructor}catch(t){}Ms&&Ms(uc,hc)}Hs({global:!0,constructor:!0,wrap:!0,forced:ic},{Promise:dc}),Gs(dc,oc,!1),qs(oc);var jc=ao,Rc=u,_c=Le,Lc=pt,Dc=go,Ic=dr,Bc=V,Hc=ei,Nc=Yo,Wc=uo,Uc=TypeError,Fc=function(t,e){this.stopped=t,this.result=e},Mc=Fc.prototype,Gc=function(t,e,n){var r,o,i,a,s,c,l,u=n&&n.that,d=!(!n||!n.AS_ENTRIES),h=!(!n||!n.IS_RECORD),f=!(!n||!n.IS_ITERATOR),p=!(!n||!n.INTERRUPTED),v=jc(e,u),y=function(t){return r&&Wc(r,"normal",t),new Fc(!0,t)},m=function(t){return d?(_c(t),p?v(t[0],t[1],y):v(t[0],t[1])):p?v(t,y):v(t)};if(h)r=t.iterator;else if(f)r=t;else{if(!(o=Nc(t)))throw new Uc(Lc(t)+" is not iterable");if(Dc(o)){for(i=0,a=Ic(t);a>i;i++)if((s=m(t[i]))&&Bc(Mc,s))return s;return new Fc(!1)}r=Hc(t,o)}for(c=h?t.next:r.next;!(l=Rc(c,r)).done;){try{s=m(l.value)}catch(t){Wc(r,"throw",t)}if("object"==typeof s&&s&&Bc(Mc,s))return s}return new Fc(!1)},qc=ys,zc=As.CONSTRUCTOR||!mi((function(t){qc.all(t).then(void 0,(function(){}))})),Vc=u,Xc=gt,Yc=js,$c=vs,Kc=Gc;Qr({target:"Promise",stat:!0,forced:zc},{all:function(t){var e=this,n=Yc.f(e),r=n.resolve,o=n.reject,i=$c((function(){var n=Xc(e.resolve),i=[],a=0,s=1;Kc(t,(function(t){var c=a++,l=!1;s++,Vc(n,e,t).then((function(t){l||(l=!0,i[c]=t,--s||r(i))}),o)})),--s||r(i)}));return i.error&&o(i.value),n.promise}});var Jc=Qr,Zc=As.CONSTRUCTOR,Qc=ys,tl=z,el=U,nl=Zn,rl=Qc&&Qc.prototype;if(Jc({target:"Promise",proto:!0,forced:Zc,real:!0},{catch:function(t){return this.then(void 0,t)}}),el(Qc)){var ol=tl("Promise").prototype.catch;rl.catch!==ol&&nl(rl,"catch",ol,{unsafe:!0})}var il=u,al=gt,sl=js,cl=vs,ll=Gc;Qr({target:"Promise",stat:!0,forced:zc},{race:function(t){var e=this,n=sl.f(e),r=n.reject,o=cl((function(){var o=al(e.resolve);ll(t,(function(t){il(o,e,t).then(n.resolve,r)}))}));return o.error&&r(o.value),n.promise}});var ul=js;Qr({target:"Promise",stat:!0,forced:As.CONSTRUCTOR},{reject:function(t){var e=ul.f(this);return(0,e.reject)(t),e.promise}});var dl=Le,hl=M,fl=js,pl=Qr,vl=As.CONSTRUCTOR,yl=function(t,e){if(dl(t),hl(e)&&e.constructor===t)return e;var n=fl.f(t);return(0,n.resolve)(e),n.promise};z("Promise"),pl({target:"Promise",stat:!0,forced:vl},{resolve:function(t){return yl(this,t)}});var ml={},gl=Sr,wl=Or,bl=Object.keys||function(t){return gl(t,wl)},xl=a,Sl=Ae,Ol=Ce,Pl=Le,El=N,Tl=bl;ml.f=xl&&!Sl?Object.defineProperties:function(t,e){Pl(t);for(var n,r=El(e),o=Tl(e),i=o.length,a=0;i>a;)Ol.f(t,n=o[a++],r[n]);return t};var kl,Cl=Le,Al=ml,jl=Or,Rl=vn,_l=la,Ll=ye,Dl="prototype",Il="script",Bl=pn("IE_PROTO"),Hl=function(){},Nl=function(t){return"<"+Il+">"+t+"</"+Il+">"},Wl=function(t){t.write(Nl("")),t.close();var e=t.parentWindow.Object;return t=null,e},Ul=function(){try{kl=new ActiveXObject("htmlfile")}catch(t){}var t,e,n;Ul="undefined"!=typeof document?document.domain&&kl?Wl(kl):(e=Ll("iframe"),n="java"+Il+":",e.style.display="none",_l.appendChild(e),e.src=String(n),(t=e.contentWindow.document).open(),t.write(Nl("document.F=Object")),t.close(),t.F):Wl(kl);for(var r=jl.length;r--;)delete Ul[Dl][jl[r]];return Ul()};Rl[Bl]=!0;var Fl=ne,Ml=Object.create||function(t,e){var n;return null!==t?(Hl[Dl]=Cl(t),n=new Hl,Hl[Dl]=null,n[Bl]=t):n=Ul(),void 0===e?n:Al.f(n,e)},Gl=Ce.f,ql=Fl("unscopables"),zl=Array.prototype;void 0===zl[ql]&&Gl(zl,ql,{configurable:!0,value:Ml(null)});var Vl=function(t){zl[ql][t]=!0},Xl=yr.includes,Yl=Vl;Qr({target:"Array",proto:!0,forced:i((function(){return!Array(1).includes()}))},{includes:function(t){return Xl(this,t,arguments.length>1?arguments[1]:void 0)}}),Yl("includes");var $l=Wt,Kl=sr,Jl=dr,Zl=function(t){for(var e=$l(this),n=Jl(e),r=arguments.length,o=Kl(r>1?arguments[1]:void 0,n),i=r>2?arguments[2]:void 0,a=void 0===i?n:Kl(i,n);a>o;)e[o++]=t;return e},Ql=Vl;Qr({target:"Array",proto:!0},{fill:Zl}),Ql("fill");var tu="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof self&&self||"undefined"!=typeof global&&global||{},eu="URLSearchParams"in tu,nu="Symbol"in tu&&"iterator"in Symbol,ru="FileReader"in tu&&"Blob"in tu&&function(){try{return new Blob,!0}catch(t){return!1}}(),ou="FormData"in tu,iu="ArrayBuffer"in tu;if(iu)var au=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],su=ArrayBuffer.isView||function(t){return t&&au.indexOf(Object.prototype.toString.call(t))>-1};function cu(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(t)||""===t)throw new TypeError('Invalid character in header field name: "'+t+'"');return t.toLowerCase()}function lu(t){return"string"!=typeof t&&(t=String(t)),t}function uu(t){var e={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return nu&&(e[Symbol.iterator]=function(){return e}),e}function du(t){this.map={},t instanceof du?t.forEach((function(t,e){this.append(e,t)}),this):Array.isArray(t)?t.forEach((function(t){if(2!=t.length)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+t.length);this.append(t[0],t[1])}),this):t&&Object.getOwnPropertyNames(t).forEach((function(e){this.append(e,t[e])}),this)}function hu(t){if(!t._noBody)return t.bodyUsed?Promise.reject(new TypeError("Already read")):void(t.bodyUsed=!0)}function fu(t){return new Promise((function(e,n){t.onload=function(){e(t.result)},t.onerror=function(){n(t.error)}}))}function pu(t){var e=new FileReader,n=fu(e);return e.readAsArrayBuffer(t),n}function vu(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function yu(){return this.bodyUsed=!1,this._initBody=function(t){var e;this.bodyUsed=this.bodyUsed,this._bodyInit=t,t?"string"==typeof t?this._bodyText=t:ru&&Blob.prototype.isPrototypeOf(t)?this._bodyBlob=t:ou&&FormData.prototype.isPrototypeOf(t)?this._bodyFormData=t:eu&&URLSearchParams.prototype.isPrototypeOf(t)?this._bodyText=t.toString():iu&&ru&&((e=t)&&DataView.prototype.isPrototypeOf(e))?(this._bodyArrayBuffer=vu(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):iu&&(ArrayBuffer.prototype.isPrototypeOf(t)||su(t))?this._bodyArrayBuffer=vu(t):this._bodyText=t=Object.prototype.toString.call(t):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):eu&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},ru&&(this.blob=function(){var t=hu(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer){var t=hu(this);return t||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}if(ru)return this.blob().then(pu);throw new Error("could not read as ArrayBuffer")},this.text=function(){var t=hu(this);if(t)return t;if(this._bodyBlob)return function(t){var e=new FileReader,n=fu(e),r=/charset=([A-Za-z0-9_-]+)/.exec(t.type),o=r?r[1]:"utf-8";return e.readAsText(t,o),n}(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(function(t){for(var e=new Uint8Array(t),n=new Array(e.length),r=0;r<e.length;r++)n[r]=String.fromCharCode(e[r]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},ou&&(this.formData=function(){return this.text().then(wu)}),this.json=function(){return this.text().then(JSON.parse)},this}du.prototype.append=function(t,e){t=cu(t),e=lu(e);var n=this.map[t];this.map[t]=n?n+", "+e:e},du.prototype.delete=function(t){delete this.map[cu(t)]},du.prototype.get=function(t){return t=cu(t),this.has(t)?this.map[t]:null},du.prototype.has=function(t){return this.map.hasOwnProperty(cu(t))},du.prototype.set=function(t,e){this.map[cu(t)]=lu(e)},du.prototype.forEach=function(t,e){for(var n in this.map)this.map.hasOwnProperty(n)&&t.call(e,this.map[n],n,this)},du.prototype.keys=function(){var t=[];return this.forEach((function(e,n){t.push(n)})),uu(t)},du.prototype.values=function(){var t=[];return this.forEach((function(e){t.push(e)})),uu(t)},du.prototype.entries=function(){var t=[];return this.forEach((function(e,n){t.push([n,e])})),uu(t)},nu&&(du.prototype[Symbol.iterator]=du.prototype.entries);var mu=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function gu(t,e){if(!(this instanceof gu))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');var n=(e=e||{}).body;if(t instanceof gu){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new du(t.headers)),this.method=t.method,this.mode=t.mode,this.signal=t.signal,n||null==t._bodyInit||(n=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"same-origin",!e.headers&&this.headers||(this.headers=new du(e.headers)),this.method=function(t){var e=t.toUpperCase();return mu.indexOf(e)>-1?e:t}(e.method||this.method||"GET"),this.mode=e.mode||this.mode||null,this.signal=e.signal||this.signal||function(){if("AbortController"in tu)return(new AbortController).signal}(),this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&n)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(n),!("GET"!==this.method&&"HEAD"!==this.method||"no-store"!==e.cache&&"no-cache"!==e.cache)){var r=/([?&])_=[^&]*/;if(r.test(this.url))this.url=this.url.replace(r,"$1_="+(new Date).getTime());else{this.url+=(/\?/.test(this.url)?"&":"?")+"_="+(new Date).getTime()}}}function wu(t){var e=new FormData;return t.trim().split("&").forEach((function(t){if(t){var n=t.split("="),r=n.shift().replace(/\+/g," "),o=n.join("=").replace(/\+/g," ");e.append(decodeURIComponent(r),decodeURIComponent(o))}})),e}function bu(t,e){if(!(this instanceof bu))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(e||(e={}),this.type="default",this.status=void 0===e.status?200:e.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=void 0===e.statusText?"":""+e.statusText,this.headers=new du(e.headers),this.url=e.url||"",this._initBody(t)}gu.prototype.clone=function(){return new gu(this,{body:this._bodyInit})},yu.call(gu.prototype),yu.call(bu.prototype),bu.prototype.clone=function(){return new bu(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new du(this.headers),url:this.url})},bu.error=function(){var t=new bu(null,{status:200,statusText:""});return t.ok=!1,t.status=0,t.type="error",t};var xu=[301,302,303,307,308];bu.redirect=function(t,e){if(-1===xu.indexOf(e))throw new RangeError("Invalid status code");return new bu(null,{status:e,headers:{location:t}})};var Su=tu.DOMException;try{new Su}catch(t){(Su=function(t,e){this.message=t,this.name=e;var n=Error(t);this.stack=n.stack}).prototype=Object.create(Error.prototype),Su.prototype.constructor=Su}function Ou(t,e){return new Promise((function(n,r){var o=new gu(t,e);if(o.signal&&o.signal.aborted)return r(new Su("Aborted","AbortError"));var i=new XMLHttpRequest;function a(){i.abort()}if(i.onload=function(){var t,e,r={statusText:i.statusText,headers:(t=i.getAllResponseHeaders()||"",e=new du,t.replace(/\r?\n[\t ]+/g," ").split("\r").map((function(t){return 0===t.indexOf("\n")?t.substr(1,t.length):t})).forEach((function(t){var n=t.split(":"),r=n.shift().trim();if(r){var o=n.join(":").trim();try{e.append(r,o)}catch(t){}}})),e)};0===o.url.indexOf("file://")&&(i.status<200||i.status>599)?r.status=200:r.status=i.status,r.url="responseURL"in i?i.responseURL:r.headers.get("X-Request-URL");var a="response"in i?i.response:i.responseText;setTimeout((function(){n(new bu(a,r))}),0)},i.onerror=function(){setTimeout((function(){r(new TypeError("Network request failed"))}),0)},i.ontimeout=function(){setTimeout((function(){r(new TypeError("Network request timed out"))}),0)},i.onabort=function(){setTimeout((function(){r(new Su("Aborted","AbortError"))}),0)},i.open(o.method,function(t){try{return""===t&&tu.location.href?tu.location.href:t}catch(e){return t}}(o.url),!0),"include"===o.credentials?i.withCredentials=!0:"omit"===o.credentials&&(i.withCredentials=!1),"responseType"in i&&(ru?i.responseType="blob":iu&&(i.responseType="arraybuffer")),e&&"object"==typeof e.headers&&!(e.headers instanceof du||tu.Headers&&e.headers instanceof tu.Headers)){var s=[];Object.getOwnPropertyNames(e.headers).forEach((function(t){s.push(cu(t)),i.setRequestHeader(t,lu(e.headers[t]))})),o.headers.forEach((function(t,e){-1===s.indexOf(e)&&i.setRequestHeader(e,t)}))}else o.headers.forEach((function(t,e){i.setRequestHeader(e,t)}));o.signal&&(o.signal.addEventListener("abort",a),i.onreadystatechange=function(){4===i.readyState&&o.signal.removeEventListener("abort",a)}),i.send(void 0===o._bodyInit?null:o._bodyInit)}))}Ou.polyfill=!0,tu.fetch||(tu.fetch=Ou,tu.Headers=du,tu.Request=gu,tu.Response=bu),"undefined"==typeof CanvasRenderingContext2D||CanvasRenderingContext2D.prototype.resetTransform||(CanvasRenderingContext2D.prototype.resetTransform=function(){this.setTransform(1,0,0,1,0,0)});!function(t,e){void 0===e&&(e={});var n=e.insertAt;if("undefined"!=typeof document){var r=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css","top"===n&&r.firstChild?r.insertBefore(o,r.firstChild):r.appendChild(o),o.styleSheet?o.styleSheet.cssText=t:o.appendChild(document.createTextNode(t))}}("@keyframes watermark{0%{background-position:0 0}25%{background-position:100% 100%}50%{background-position:0 0}75%{background-position:100% -100%}to{background-position:0 0}}");var Pu=function(t,e){return Pu=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},Pu(t,e)};var Eu=function(){return Eu=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},Eu.apply(this,arguments)};function Tu(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{c(r.next(t))}catch(t){i(t)}}function s(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}c((r=r.apply(t,e||[])).next())}))}function ku(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=e.call(t,a)}catch(t){s=[6,t],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}}var Cu=function(t){return t.toDataURL("image/png",1)},Au=function(t){return"function"==typeof t},ju=function(t){return void 0===t},Ru=function(t,e,n){void 0===e&&(e={}),void 0===n&&(n="http://www.w3.org/2000/svg");var r=document.createElementNS(n,t);for(var o in e)r.setAttribute(o,e[o]);return r},_u=function(t,e){return Tu(void 0,void 0,void 0,(function(){var n,r,o,i,a,s,c,l,u;return ku(this,(function(d){switch(d.label){case 0:return n=Ru("svg",{xmlns:"http://www.w3.org/2000/svg"}),(r=document.createElement("div")).setAttribute("xmlns","http://www.w3.org/1999/xhtml"),r.style.cssText="\n  text-align: center;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 100%;\n  height: 100%;\n  font: ".concat(t.font,";\n  color: ").concat(e.fontColor,";\n"),r.innerHTML="<div class='rich-text-content'>".concat(e.content,"</div>"),document.body.appendChild(r),[4,Lu(r)];case 1:return d.sent(),o=null===(u=r.querySelector(".rich-text-content"))||void 0===u?void 0:u.getBoundingClientRect(),i=null==o?void 0:o.width,a=null==o?void 0:o.height,document.body.removeChild(r),s=e.richTextWidth||i||e.width,c=e.richTextHeight||a||e.height,n.setAttribute("width",s.toString()),n.setAttribute("height",c.toString()),(l=Ru("foreignObject",{width:s.toString(),height:c.toString()})).appendChild(r),n.appendChild(l),[2,{element:n,width:s,height:c}]}}))}))};function Lu(t){return Tu(this,void 0,void 0,(function(){var e,n,r,o,i;return ku(this,(function(a){switch(a.label){case 0:e=t.querySelectorAll("img"),n=function(t){var e,n,r,o;return ku(this,(function(i){switch(i.label){case 0:if(!(e=t.getAttribute("src")))return[3,6];i.label=1;case 1:return i.trys.push([1,5,,6]),[4,fetch(e)];case 2:return[4,i.sent().blob()];case 3:return n=i.sent(),[4,new Promise((function(t,e){var r=new FileReader;r.onloadend=function(){return t(r.result)},r.onerror=e,r.readAsDataURL(n)}))];case 4:return r=i.sent(),"string"==typeof r&&t.setAttribute("src",r),[3,6];case 5:return o=i.sent(),console.error("Error converting ".concat(e," to base64:"),o),[3,6];case 6:return[2]}}))},r=0,o=Array.from(e),a.label=1;case 1:return r<o.length?(i=o[r],[5,n(i)]):[3,4];case 2:a.sent(),a.label=3;case 3:return r++,[3,1];case 4:return[2]}}))}))}var Du=function(t,e){return ju(t)?e:t},Iu=function(t,e,n){void 0===e&&(e=void 0),void 0===n&&(n=void 0);var r=new Image;return r.setAttribute("crossOrigin","Anonymous"),!ju(e)&&(r.width=e),!ju(n)&&(r.height=n),r.src=t,new Promise((function(t){r.onload=function(){t(r)}}))},Bu={width:300,height:300,rotate:45,layout:"default",auxiliaryLine:!1,translatePlacement:"middle",contentType:"text",content:"hello watermark-js-plus",textType:"fill",imageWidth:0,imageHeight:0,lineHeight:30,zIndex:2147483647,backgroundPosition:"0 0",backgroundRepeat:"repeat",fontSize:"20px",fontFamily:"sans-serif",fontStyle:"",fontVariant:"",fontColor:"#000",fontWeight:"normal",filter:"none",letterSpacing:"0px",wordSpacing:"0px",globalAlpha:.5,mode:"default",mutationObserve:!0,monitorProtection:!1,movable:!1,parent:"body",onSuccess:function(){},onBeforeDestroy:function(){},onDestroyed:function(){},onObserveError:function(){}},Hu=function(t){"undefined"!=typeof window&&t&&(Object.defineProperty(window,"MutationObserver",{writable:!1,configurable:!1}),Object.defineProperty(window,"requestAnimationFrame",{writable:!1,configurable:!1}))},Nu=function(){function t(e,n){this.props=e,this.options=n,this.canvas=t.createCanvas(this.options.width,this.options.height),this.recommendOptions=function(t,e,n){var r=t.getContext("2d");if(null===r)throw new Error("get context error");r.font="".concat(e.fontStyle," ").concat(e.fontVariant," ").concat(e.fontWeight," ").concat(e.fontSize," ").concat(e.fontFamily),r.filter=e.filter,r.letterSpacing=e.letterSpacing,r.wordSpacing=e.wordSpacing,(null==e?void 0:e.rotate)&&(e.rotate=(360-e.rotate%360)*(Math.PI/180)),ju(n.textRowMaxWidth)&&(e.textRowMaxWidth=e.width);var o={image:{rect:{width:e.imageWidth,height:e.imageHeight},position:{x:0,y:0}},textLine:{data:[],yOffsetValue:0},advancedStyleParams:{linear:{x0:0,x1:0},radial:{x0:0,y0:0,r0:0,x1:0,y1:0,r1:0},conic:{x:0,y:0,startAngle:0},pattern:{}}};switch(e.contentType){case"text":o.textLine.data=[e.content];break;case"multi-line-text":o.textLine.data=function(t,e,n){for(var r=[],o="",i="",a=0,s=e.length;a<s;a++)"\n"!==(i=e.charAt(a))?(o+=i,t.measureText(o).width>n&&(r.push(o.substring(0,o.length-1)),o="",a--)):(r.push(o),o="");return r.push(o),r}(r,e.content,e.textRowMaxWidth)}var i=e.width/2,a=e.height/2,s="middle",c="center";switch(ju(null==n?void 0:n.translateX)||ju(null==n?void 0:n.translateY)?(o.advancedStyleParams.linear.x0=-e.width/2,o.advancedStyleParams.linear.x1=e.width/2,o.advancedStyleParams.radial.r0=0,o.advancedStyleParams.radial.r1=e.width/2):(i=null==n?void 0:n.translateX,a=null==n?void 0:n.translateY,s="top",c="left"),n.translatePlacement){case"top":i=e.width/2,a=0,s="top",o.advancedStyleParams.linear.x0=-e.width/2,o.advancedStyleParams.linear.x1=e.width/2,o.advancedStyleParams.radial.y0=o.textLine.data.length*e.lineHeight/2,o.advancedStyleParams.radial.y1=o.textLine.data.length*e.lineHeight/2,o.advancedStyleParams.conic.y=o.textLine.data.length*e.lineHeight/2;break;case"top-start":i=0,a=0,s="top",c="start",o.advancedStyleParams.linear.x0=0,o.advancedStyleParams.linear.x1=e.width,o.advancedStyleParams.radial.x0=e.width/2,o.advancedStyleParams.radial.y0=o.textLine.data.length*e.lineHeight/2,o.advancedStyleParams.radial.x1=e.width/2,o.advancedStyleParams.radial.y1=o.textLine.data.length*e.lineHeight/2,o.advancedStyleParams.conic.x=e.width/2,o.advancedStyleParams.conic.y=o.textLine.data.length*e.lineHeight/2;break;case"top-end":i=e.width,a=0,s="top",c="end",o.advancedStyleParams.linear.x0=0,o.advancedStyleParams.linear.x1=-e.width,o.advancedStyleParams.radial.x0=-e.width/2,o.advancedStyleParams.radial.y0=o.textLine.data.length*e.lineHeight/2,o.advancedStyleParams.radial.x1=-e.width/2,o.advancedStyleParams.radial.y1=o.textLine.data.length*e.lineHeight/2,o.advancedStyleParams.conic.x=-e.width/2,o.advancedStyleParams.conic.y=o.textLine.data.length*e.lineHeight/2;break;case"bottom":i=e.width/2,a=e.height,s="bottom",o.advancedStyleParams.linear.x0=-e.width/2,o.advancedStyleParams.linear.x1=e.width/2,o.advancedStyleParams.radial.y0=-o.textLine.data.length*e.lineHeight/2,o.advancedStyleParams.radial.y1=-o.textLine.data.length*e.lineHeight/2,o.advancedStyleParams.conic.x=0,o.advancedStyleParams.conic.y=-o.textLine.data.length*e.lineHeight/2;break;case"bottom-start":i=0,a=e.height,s="bottom",c="start",o.advancedStyleParams.linear.x0=0,o.advancedStyleParams.linear.x1=e.width,o.advancedStyleParams.radial.x0=e.width/2,o.advancedStyleParams.radial.y0=-o.textLine.data.length*e.lineHeight/2,o.advancedStyleParams.radial.x1=e.width/2,o.advancedStyleParams.radial.y1=-o.textLine.data.length*e.lineHeight/2,o.advancedStyleParams.conic.x=e.width/2,o.advancedStyleParams.conic.y=-o.textLine.data.length*e.lineHeight/2;break;case"bottom-end":i=e.width,a=e.height,s="bottom",c="end",o.advancedStyleParams.linear.x0=0,o.advancedStyleParams.linear.x1=-e.width,o.advancedStyleParams.radial.x0=-e.width/2,o.advancedStyleParams.radial.y0=-o.textLine.data.length*e.lineHeight/2,o.advancedStyleParams.radial.x1=-e.width/2,o.advancedStyleParams.radial.y1=-o.textLine.data.length*e.lineHeight/2,o.advancedStyleParams.conic.x=-e.width/2,o.advancedStyleParams.conic.y=-o.textLine.data.length*e.lineHeight/2;break;case"left":i=0,a=e.height/2,c="start",o.advancedStyleParams.linear.x0=0,o.advancedStyleParams.linear.x1=e.width,o.advancedStyleParams.radial.x0=e.width/2,o.advancedStyleParams.radial.x1=e.width/2,o.advancedStyleParams.conic.x=e.width/2,o.advancedStyleParams.conic.y=0;break;case"right":i=e.width,a=e.height/2,c="end",o.advancedStyleParams.linear.x0=0,o.advancedStyleParams.linear.x1=-e.width,o.advancedStyleParams.radial.x0=-e.width/2,o.advancedStyleParams.radial.x1=-e.width/2,o.advancedStyleParams.conic.x=-e.width/2,o.advancedStyleParams.conic.y=0}if(e.translateX=i,e.translateY=a,ju(null==n?void 0:n.textBaseline)&&(e.textBaseline=s),ju(null==n?void 0:n.textAlign)&&(e.textAlign=c),["text","multi-line-text"].includes(e.contentType))switch(e.textBaseline){case"middle":o.textLine.yOffsetValue=(o.textLine.data.length-1)*e.lineHeight/2;break;case"bottom":case"alphabetic":case"ideographic":o.textLine.yOffsetValue=(o.textLine.data.length-1)*e.lineHeight+(e.lineHeight-parseInt(e.fontSize))/2;break;case"top":case"hanging":o.textLine.yOffsetValue=-e.lineHeight/2+parseInt(e.fontSize)/2}return o}(this.canvas,this.options,this.props)}return t.createCanvas=function(t,e){var n,r=window.devicePixelRatio||1,o=document.createElement("canvas");return o.width=t*r,o.height=e*r,o.style.width="".concat(t,"px"),o.style.height="".concat(e,"px"),null===(n=o.getContext("2d"))||void 0===n||n.setTransform(r,0,0,r,0,0),o},t.clearCanvas=function(t){var e=t.getContext("2d");if(null===e)throw new Error("get context error");e.restore(),e.resetTransform(),e.clearRect(0,0,t.width,t.height);var n=window.devicePixelRatio||1;e.setTransform(n,0,0,n,0,0)},t.prototype.getCanvas=function(){return this.canvas},t.prototype.clear=function(){t.clearCanvas(this.canvas)},t.prototype.draw=function(){var t=this,e=this.canvas.getContext("2d");if(null===e)throw new Error("get context error");return this.options.auxiliaryLine&&(e.beginPath(),e.rect(0,0,this.options.width,this.options.height),e.lineWidth=1,e.strokeStyle="#000",e.stroke(),e.closePath(),e.beginPath(),e.rect(this.options.translateX,this.options.translateY,1,1),e.lineWidth=1,e.strokeStyle="#f00",e.stroke(),e.closePath()),this.setStyle(e),e.save(),e.translate(this.options.translateX,this.options.translateY),e.rotate(this.options.rotate),new Promise((function(n){switch(t.options.contentType){case"text":t.drawText(e,n);break;case"image":t.drawImage(e,n);break;case"multi-line-text":t.drawMultiLineText(e,n);break;case"rich-text":t.drawRichText(e,n)}}))},t.prototype.setStyle=function(t){var e,n="fillStyle";"stroke"===this.options.textType&&(n="strokeStyle");var r=this.options.fontColor;if(null===(e=this.options)||void 0===e?void 0:e.advancedStyle)switch(this.options.advancedStyle.type){case"linear":r=this.createLinearGradient(t);break;case"radial":r=this.createRadialGradient(t);break;case"conic":r=this.createConicGradient(t);break;case"pattern":r=this.createPattern(t)}t[n]&&r&&(t[n]=r),this.options.textAlign&&(t.textAlign=this.options.textAlign),this.options.textBaseline&&(t.textBaseline=this.options.textBaseline),t.globalAlpha=this.options.globalAlpha,this.options.shadowStyle&&(t.shadowBlur=Du(this.options.shadowStyle.shadowBlur,0),t.shadowColor=Du(this.options.shadowStyle.shadowColor,"#00000000"),t.shadowOffsetX=Du(this.options.shadowStyle.shadowOffsetX,0),t.shadowOffsetY=Du(this.options.shadowStyle.shadowOffsetY,0)),Au(this.options.extraDrawFunc)&&this.options.extraDrawFunc(t)},t.prototype.createLinearGradient=function(t){var e,n,r,o,i,a,s,c,l,u,d,h,f,p,v,y=t.createLinearGradient(Du(null===(r=null===(n=null===(e=this.options.advancedStyle)||void 0===e?void 0:e.params)||void 0===n?void 0:n.linear)||void 0===r?void 0:r.x0,this.recommendOptions.advancedStyleParams.linear.x0),Du(null===(a=null===(i=null===(o=this.options.advancedStyle)||void 0===o?void 0:o.params)||void 0===i?void 0:i.linear)||void 0===a?void 0:a.y0,0),Du(null===(l=null===(c=null===(s=this.options.advancedStyle)||void 0===s?void 0:s.params)||void 0===c?void 0:c.linear)||void 0===l?void 0:l.x1,this.recommendOptions.advancedStyleParams.linear.x1),Du(null===(h=null===(d=null===(u=this.options.advancedStyle)||void 0===u?void 0:u.params)||void 0===d?void 0:d.linear)||void 0===h?void 0:h.y1,0));return null===(v=null===(p=null===(f=this.options)||void 0===f?void 0:f.advancedStyle)||void 0===p?void 0:p.colorStops)||void 0===v||v.forEach((function(t){y.addColorStop(t.offset,t.color)})),y},t.prototype.createConicGradient=function(t){var e,n,r,o,i,a,s,c,l,u,d,h,f,p,v,y=t.createConicGradient(Du(null===(o=null===(r=null===(n=null===(e=this.options)||void 0===e?void 0:e.advancedStyle)||void 0===n?void 0:n.params)||void 0===r?void 0:r.conic)||void 0===o?void 0:o.startAngle,0),Du(null===(c=null===(s=null===(a=null===(i=this.options)||void 0===i?void 0:i.advancedStyle)||void 0===a?void 0:a.params)||void 0===s?void 0:s.conic)||void 0===c?void 0:c.x,this.recommendOptions.advancedStyleParams.conic.x),Du(null===(h=null===(d=null===(u=null===(l=this.options)||void 0===l?void 0:l.advancedStyle)||void 0===u?void 0:u.params)||void 0===d?void 0:d.conic)||void 0===h?void 0:h.y,this.recommendOptions.advancedStyleParams.conic.y));return null===(v=null===(p=null===(f=this.options)||void 0===f?void 0:f.advancedStyle)||void 0===p?void 0:p.colorStops)||void 0===v||v.forEach((function(t){y.addColorStop(t.offset,t.color)})),y},t.prototype.createRadialGradient=function(t){var e,n,r,o,i,a,s,c,l,u,d,h,f,p,v,y,m,g,w,b,x,S,O,P,E,T,k,C=t.createRadialGradient(Du(null===(o=null===(r=null===(n=null===(e=this.options)||void 0===e?void 0:e.advancedStyle)||void 0===n?void 0:n.params)||void 0===r?void 0:r.radial)||void 0===o?void 0:o.x0,this.recommendOptions.advancedStyleParams.radial.x0),Du(null===(c=null===(s=null===(a=null===(i=this.options)||void 0===i?void 0:i.advancedStyle)||void 0===a?void 0:a.params)||void 0===s?void 0:s.radial)||void 0===c?void 0:c.y0,this.recommendOptions.advancedStyleParams.radial.y0),Du(null===(h=null===(d=null===(u=null===(l=this.options)||void 0===l?void 0:l.advancedStyle)||void 0===u?void 0:u.params)||void 0===d?void 0:d.radial)||void 0===h?void 0:h.r0,this.recommendOptions.advancedStyleParams.radial.r0),Du(null===(y=null===(v=null===(p=null===(f=this.options)||void 0===f?void 0:f.advancedStyle)||void 0===p?void 0:p.params)||void 0===v?void 0:v.radial)||void 0===y?void 0:y.x1,this.recommendOptions.advancedStyleParams.radial.x1),Du(null===(b=null===(w=null===(g=null===(m=this.options)||void 0===m?void 0:m.advancedStyle)||void 0===g?void 0:g.params)||void 0===w?void 0:w.radial)||void 0===b?void 0:b.y1,this.recommendOptions.advancedStyleParams.radial.y1),Du(null===(P=null===(O=null===(S=null===(x=this.options)||void 0===x?void 0:x.advancedStyle)||void 0===S?void 0:S.params)||void 0===O?void 0:O.radial)||void 0===P?void 0:P.r1,this.recommendOptions.advancedStyleParams.radial.r1));return null===(k=null===(T=null===(E=this.options)||void 0===E?void 0:E.advancedStyle)||void 0===T?void 0:T.colorStops)||void 0===k||k.forEach((function(t){C.addColorStop(t.offset,t.color)})),C},t.prototype.createPattern=function(t){var e,n,r,o,i,a,s,c;return t.createPattern(null===(o=null===(r=null===(n=null===(e=this.options)||void 0===e?void 0:e.advancedStyle)||void 0===n?void 0:n.params)||void 0===r?void 0:r.pattern)||void 0===o?void 0:o.image,(null===(c=null===(s=null===(a=null===(i=this.options)||void 0===i?void 0:i.advancedStyle)||void 0===a?void 0:a.params)||void 0===s?void 0:s.pattern)||void 0===c?void 0:c.repetition)||"")},t.prototype.setText=function(t,e){var n="fillText";"stroke"===this.options.textType&&(n="strokeText"),t[n]&&t[n](e.text,e.x,e.y,e.maxWidth)},t.prototype.drawText=function(t,e){this.setText(t,{text:this.options.content,x:0,y:0-this.recommendOptions.textLine.yOffsetValue,maxWidth:this.options.textRowMaxWidth||this.options.width}),e(t.canvas)},t.prototype.drawImage=function(t,e){var n=this;Iu(this.options.image).then((function(r){var o=n.getImageRect(r),i=o.width,a=o.height,s=n.getDrawImagePosition(i,a);t.drawImage(r,s.x,s.y,i,a),e(t.canvas)}))},t.prototype.drawMultiLineText=function(t,e){var n=this,r=this.recommendOptions.textLine.data,o=this.recommendOptions.textLine.yOffsetValue;r.forEach((function(e,r){n.setText(t,{text:e,x:0,y:n.options.lineHeight*r-o,maxWidth:n.options.textRowMaxWidth||n.options.width})})),e(t.canvas)},t.prototype.drawRichText=function(t,e){return Tu(this,void 0,void 0,(function(){var n,r=this;return ku(this,(function(o){switch(o.label){case 0:return[4,_u(t,this.options)];case 1:return n=o.sent(),Iu((i=n.element,a=i.outerHTML.replace(/<(img|br|input|hr|embed)(.*?)>/g,"<$1$2/>").replace(/\n/g,"").replace(/\t/g,"").replace(/#/g,"%23"),"data:image/svg+xml;charset=utf-8,".concat(a)),n.width,n.height).then((function(n){var o=r.getDrawImagePosition(n.width,n.height);t.drawImage(n,o.x,o.y,n.width,n.height),e(t.canvas)})),[2]}var i,a}))}))},t.prototype.getImageRect=function(t){var e={width:this.options.imageWidth||0,height:this.options.imageHeight||0};switch(!0){case 0!==e.width&&0===e.height:e.height=e.width*t.height/t.width;break;case 0===e.width&&0!==e.height:e.width=e.height*t.width/t.height;break;case 0===e.width&&0===e.height:e.width=t.width,e.height=t.height}return e},t.prototype.getDrawImagePosition=function(t,e){var n,r,o={x:-t/2,y:-e/2};switch(this.options.translatePlacement){case"top":o.x=-t/2,o.y=0;break;case"top-start":o.x=0,o.y=0;break;case"top-end":o.x=-t,o.y=0;break;case"bottom":o.x=-t/2,o.y=-e;break;case"bottom-start":o.x=0,o.y=-e;break;case"bottom-end":o.x=-t,o.y=-e;break;case"left":o.x=0,o.y=-e/2;break;case"right":o.x=-t,o.y=-e/2}return!ju(null===(n=this.props)||void 0===n?void 0:n.translateX)&&(o.x=0),!ju(null===(r=this.props)||void 0===r?void 0:r.translateY)&&(o.y=0),o},t}(),Wu=function(){function t(t,e){var n,r,o,i,a,s,c;this.options=t,this.partialWidth=this.options.width,this.partialHeight=this.options.height,this.rows=(null===(n=this.options.gridLayoutOptions)||void 0===n?void 0:n.rows)||1,this.cols=(null===(r=this.options.gridLayoutOptions)||void 0===r?void 0:r.cols)||1,this.matrix=(null===(o=this.options.gridLayoutOptions)||void 0===o?void 0:o.matrix)||(a=this.rows,s=this.cols,c=1,Array.from({length:a},(function(){return new Array(s).fill(c)}))),this.gap=(null===(i=this.options.gridLayoutOptions)||void 0===i?void 0:i.gap)||[0,0],this.partialCanvas=e}return t.prototype.draw=function(){var t,e,n,r,o,i,a,s,c=Nu.createCanvas((null===(t=this.options.gridLayoutOptions)||void 0===t?void 0:t.width)||this.partialWidth*this.cols+this.gap[0]*this.cols,(null===(e=this.options.gridLayoutOptions)||void 0===e?void 0:e.height)||this.partialHeight*this.rows+this.gap[1]*this.rows),l=c.getContext("2d");(null===(n=this.options.gridLayoutOptions)||void 0===n?void 0:n.backgroundImage)&&(null==l||l.drawImage(null===(r=this.options.gridLayoutOptions)||void 0===r?void 0:r.backgroundImage,0,0,null===(o=this.options.gridLayoutOptions)||void 0===o?void 0:o.width,null===(i=this.options.gridLayoutOptions)||void 0===i?void 0:i.height));for(var u=0;u<this.rows;u++)for(var d=0;d<this.cols;d++)(null===(s=null===(a=this.matrix)||void 0===a?void 0:a[u])||void 0===s?void 0:s[d])&&(null==l||l.drawImage(this.partialCanvas,this.partialWidth*d+this.gap[0]*d,this.partialHeight*u+this.gap[1]*u,this.partialWidth,this.partialHeight));return c},t}(),Uu=function(t,e){return"grid"===t.layout?new Wu(t,e).draw():e},Fu=function(){function t(t){void 0===t&&(t={}),this.parentElement=document.body,this.isCreating=!1,this.props=t,this.options=Eu(Eu({},Bu),t),this.changeParentElement(this.options.parent),this.watermarkCanvas=new Nu(this.props,this.options),Hu(this.options.monitorProtection)}return t.prototype.changeOptions=function(){return Tu(this,arguments,void 0,(function(t,e,n){return void 0===t&&(t={}),void 0===e&&(e="overwrite"),void 0===n&&(n=!0),ku(this,(function(r){switch(r.label){case 0:return this.initConfigData(t,e),Hu(this.options.monitorProtection),n?(this.remove(),[4,this.create()]):[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},t.prototype.create=function(){return Tu(this,void 0,void 0,(function(){var t,e,n,r,o,i,a,s,c,l,u,d;return ku(this,(function(h){switch(h.label){case 0:return this.isCreating?[2]:(this.isCreating=!0,this.validateUnique()&&this.validateContent()?(t=ju(this.watermarkDom),[4,null===(i=this.watermarkCanvas)||void 0===i?void 0:i.draw()]):(this.isCreating=!1,[2]));case 1:if(h.sent(),this.layoutCanvas=Uu(this.options,null===(a=this.watermarkCanvas)||void 0===a?void 0:a.getCanvas()),e=Cu(this.layoutCanvas),null===(s=this.watermarkCanvas)||void 0===s||s.clear(),this.watermarkDom=document.createElement("div"),n=document.createElement("div"),this.watermarkDom.__WATERMARK__="watermark",this.watermarkDom.__WATERMARK__INSTANCE__=this,r=this.checkParentElementType(),this.watermarkDom.style.cssText="\n      z-index:".concat(this.options.zIndex,"!important;display:block!important;visibility:visible!important;transform:none!important;scale:none!important;\n      ").concat("custom"===r?"top:0!important;bottom:0!important;left:0!important;right:0!important;height:100%!important;pointer-events:none!important;position:absolute!important;":"position:relative!important;","\n    "),o=function(t){var e,n,r;if("grid"===t.layout){var o=(null===(e=t.gridLayoutOptions)||void 0===e?void 0:e.cols)||1,i=(null===(n=t.gridLayoutOptions)||void 0===n?void 0:n.rows)||1,a=(null===(r=t.gridLayoutOptions)||void 0===r?void 0:r.gap)||[0,0];return[t.width*o+a[0]*o,t.height*i+a[1]*i]}return[t.width,t.height]}(this.options),n.style.cssText="\n      display:block!important;visibility:visible!important;pointer-events:none;top:0;bottom:0;left:0;right:0;transform:none!important;scale:none!important;\n      position:".concat("root"===r?"fixed":"absolute","!important;-webkit-print-color-adjust:exact!important;width:100%!important;height:100%!important;\n      z-index:").concat(this.options.zIndex,"!important;background-image:url(").concat(e,")!important;background-repeat:").concat(this.options.backgroundRepeat,"!important;\n      background-size:").concat(o[0],"px ").concat(o[1],"px!important;background-position:").concat(this.options.backgroundPosition,";\n      ").concat(this.options.movable?"animation: 200s ease 0s infinite normal none running watermark !important;":"","\n    "),this.watermarkDom.appendChild(n),this.parentElement.appendChild(this.watermarkDom),this.options.mutationObserve)try{this.bindMutationObserve()}catch(t){null===(l=(c=this.options).onObserveError)||void 0===l||l.call(c)}return t&&(null===(d=(u=this.options).onSuccess)||void 0===d||d.call(u)),this.isCreating=!1,[2]}}))}))},t.prototype.destroy=function(){this.remove(),this.watermarkDom=void 0},t.prototype.check=function(){return Tu(this,void 0,void 0,(function(){return ku(this,(function(t){return[2,this.parentElement.contains(this.watermarkDom)]}))}))},t.prototype.remove=function(){var t,e,n,r,o,i,a,s;null===(e=(t=this.options).onBeforeDestroy)||void 0===e||e.call(t),null===(n=this.observer)||void 0===n||n.disconnect(),null===(r=this.parentObserve)||void 0===r||r.disconnect(),this.unbindCheckWatermarkElementEvent(),null===(i=null===(o=this.watermarkDom)||void 0===o?void 0:o.parentNode)||void 0===i||i.removeChild(this.watermarkDom),null===(s=(a=this.options).onDestroyed)||void 0===s||s.call(a)},t.prototype.initConfigData=function(t,e){var n=this;void 0===e&&(e="overwrite"),"append"===e?Object.keys(t).forEach((function(e){n.props&&(n.props[e]=t[e])})):this.props=t,this.options=Eu(Eu({},Bu),this.props),this.changeParentElement(this.options.parent),this.watermarkCanvas=new Nu(this.props,this.options)},t.prototype.changeParentElement=function(t){if("string"==typeof t){var e=document.querySelector(t);e&&(this.parentElement=e)}else this.parentElement=t;this.parentElement||console.error("[WatermarkJsPlus]: please pass a valid parent element.")},t.prototype.validateUnique=function(){var t=!0;return Array.from(this.parentElement.childNodes).forEach((function(e){t&&Object.hasOwnProperty.call(e,"__WATERMARK__")&&(t=!1)})),t},t.prototype.validateContent=function(){switch(this.options.contentType){case"image":return Object.hasOwnProperty.call(this.options,"image");case"multi-line-text":case"rich-text":case"text":return this.options.content.length>0}},t.prototype.checkParentElementType=function(){return["html","body"].includes(this.parentElement.tagName.toLocaleLowerCase())?"root":"custom"},t.prototype.checkWatermarkElement=function(){return Tu(this,void 0,void 0,(function(){return ku(this,(function(t){switch(t.label){case 0:return this.parentElement.contains(this.watermarkDom)?[3,2]:(this.remove(),[4,this.create()]);case 1:t.sent(),t.label=2;case 2:return this.bindCheckWatermarkElementEvent(),[2]}}))}))},t.prototype.bindMutationObserve=function(){var t=this;this.watermarkDom&&(this.bindCheckWatermarkElementEvent(),this.observer=new MutationObserver((function(e){return Tu(t,void 0,void 0,(function(){return ku(this,(function(t){switch(t.label){case 0:return e.length>0?(this.remove(),[4,this.create()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))})),this.observer.observe(this.watermarkDom,{attributes:!0,childList:!0,subtree:!0,characterData:!0}),this.parentObserve=new MutationObserver((function(e){return Tu(t,void 0,void 0,(function(){var t,n,r,o;return ku(this,(function(i){switch(i.label){case 0:t=0,n=e,i.label=1;case 1:return t<n.length?(null==(r=n[t])?void 0:r.target)===this.watermarkDom||(null===(o=null==r?void 0:r.removedNodes)||void 0===o?void 0:o[0])===this.watermarkDom||"childList"===r.type&&r.target===this.parentElement&&r.target.lastChild!==this.watermarkDom?(this.remove(),[4,this.create()]):[3,3]:[3,4];case 2:i.sent(),i.label=3;case 3:return t++,[3,1];case 4:return[2]}}))}))})),this.parentObserve.observe(this.parentElement,{attributes:!0,childList:!0,subtree:!0,characterData:!0}))},t.prototype.bindCheckWatermarkElementEvent=function(){this.unbindCheckWatermarkElementEvent(),this.checkWatermarkElementRequestID=requestAnimationFrame(this.checkWatermarkElement.bind(this))},t.prototype.unbindCheckWatermarkElementEvent=function(){ju(this.checkWatermarkElementRequestID)||cancelAnimationFrame(this.checkWatermarkElementRequestID)},t}(),Mu=function(t){function e(e){void 0===e&&(e={});return t.call(this,Eu(Eu({},e),{globalAlpha:.005,mode:"blind"}))||this}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}Pu(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.decode=function(t){var e=t.url,n=void 0===e?"":e,r=t.fillColor,o=void 0===r?"#000":r,i=t.compositeOperation,a=void 0===i?"color-burn":i,s=t.mode,c=void 0===s?"canvas":s,l=t.compositeTimes,u=void 0===l?3:l,d=t.onSuccess;if(n&&"canvas"===c){var h=new Image;h.src=n,h.addEventListener("load",(function(){var t=h.width,e=h.height,n=Nu.createCanvas(t,e),r=n.getContext("2d");if(!r)throw new Error("get context error");r.drawImage(h,0,0,t,e),r.globalCompositeOperation=a,r.fillStyle=o;for(var i=0;i<u;i++)r.fillRect(0,0,t,e);var s=Cu(n);Au(d)&&(null==d||d(s))}))}},e}(Fu),Gu=function(){function t(t){var e;void 0===t&&(t={}),this.drew=!1,this.props=t,this.options=Eu(Eu({},Bu),t),this.watermarkCanvas=new Nu(this.props,this.options),this.originalSrc=null===(e=this.props.dom)||void 0===e?void 0:e.src,this.backgroundImage=this.getBackgroundImage()}return t.prototype.create=function(){return Tu(this,void 0,void 0,(function(){var t,e,n,r,o;return ku(this,(function(i){switch(i.label){case 0:return this.drew?[2]:[4,null===(t=this.watermarkCanvas)||void 0===t?void 0:t.draw()];case 1:return i.sent(),this.options.layout="grid",this.options.gridLayoutOptions=Eu(Eu({},this.options.gridLayoutOptions),{width:null===(e=this.backgroundImage)||void 0===e?void 0:e.width,height:null===(n=this.backgroundImage)||void 0===n?void 0:n.height,backgroundImage:this.backgroundImage}),this.layoutCanvas=Uu(this.options,null===(r=this.watermarkCanvas)||void 0===r?void 0:r.getCanvas()),this.options.dom.src=Cu(this.layoutCanvas),null===(o=this.watermarkCanvas)||void 0===o||o.clear(),this.drew=!0,[2]}}))}))},t.prototype.destroy=function(){this.options.dom.src=this.originalSrc,this.drew=!1},t.prototype.getBackgroundImage=function(){if(this.options.dom)return this.options.dom},t}();t.BlindWatermark=Mu,t.ImageWatermark=Gu,t.Watermark=Fu}));
