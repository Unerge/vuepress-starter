import{isFunction as I,isString as v,useLocaleConfig as x,wait as E}from"@vuepress/helper/client";import{ref as A,isRef as T,watch as w,inject as _,onMounted as P,onUnmounted as L,nextTick as N}from"vue";import{usePageData as H,usePageFrontmatter as M}from"vuepress/client";import"photoswipe/dist/photoswipe.css";import"./styles/photo-swipe.css";import{useFullscreen as z,useEventListener as D}from"@vueuse/core";const m=A({}),g=Symbol(__VUEPRESS_DEV__?"photoswipe":""),F=e=>{T(e)?w(()=>e.value,t=>{m.value=t}):I(e)?w(e,t=>{m.value=t}):m.value=e},f=()=>_(g),O=e=>{e.provide(g,m)},y='<div class="photo-swipe-loading"><svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" preserveAspectRatio="xMidYMid" viewBox="25 25 50 50"><animateTransform attributeName="transform" type="rotate" dur="2s" keyTimes="0;1" repeatCount="indefinite" values="0;360"></animateTransform><circle cx="50" cy="50" r="20" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round"><animate attributeName="stroke-dasharray" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="1,200;90,200;1,200"></animate><animate attributeName="stroke-dashoffset" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="0;-35px;-125px"></animate></circle></svg></div>',S=e=>v(e)?Array.from(document.querySelectorAll(e)):e.map(t=>Array.from(document.querySelectorAll(t))).flat(),p=e=>new Promise((t,a)=>{e.complete?t({type:"image",element:e,src:e.src,width:e.naturalWidth,height:e.naturalHeight,alt:e.alt,msrc:e.src}):(e.onload=()=>{t(p(e))},e.onerror=()=>{a()})}),V=e=>new Promise((t,a)=>{const o=new Image;o.src=e,o.onload=()=>{t(p(o))},o.onerror=()=>{a()}}),b=(e,{download:t=!0,fullscreen:a=!0}={})=>{e.on("uiRegister",()=>{if(e.ui.registerElement({name:"bulletsIndicator",className:"photo-swipe-bullets-indicator",appendTo:"wrapper",onInit:o=>{const s=[];let l=-1;for(let r=0;r<e.getNumItems();r++){const i=document.createElement("div");i.className="photo-swipe-bullet",i.onclick=n=>{e.goTo(s.indexOf(n.target))},s.push(i),o.appendChild(i)}e.on("change",()=>{l>=0&&s[l].classList.remove("active"),s[e.currIndex].classList.add("active"),l=e.currIndex})}}),a){const{isSupported:o,toggle:s}=z();o.value&&e.ui.registerElement({name:"fullscreen",order:7,isButton:!0,html:'<svg class="pswp__icn" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><path d="M249.5 270.833H437v-75H212a37.5 37.5 0 0 0-37.5 37.5v225h75v-187.5zm-37.5 600h225v-75H249.5v-187.5h-75v225a37.5 37.5 0 0 0 37.5 37.5zm637.5-37.5v-225h-75v187.5H587v75h225a37.5 37.5 0 0 0 37.5-37.5zM587 270.833h187.5v187.5h75v-225a37.5 37.5 0 0 0-37.5-37.5H587v75z"/></svg>',onClick:()=>{s()}})}t&&e.ui.registerElement({name:"download",order:8,isButton:!0,tagName:"a",html:{isCustomSVG:!0,inner:'<path d="M20.5 14.3 17.1 18V10h-2.2v7.9l-3.4-3.6L10 16l6 6.1 6-6.1-1.5-1.6ZM23 23H9v2h14" id="pswp__icn-download"/>',outlineID:"pswp__icn-download"},onInit:o=>{o.setAttribute("download",""),o.setAttribute("target","_blank"),o.setAttribute("rel","noopener"),e.on("change",()=>{o.setAttribute("href",e.currSlide.data.src)})}})})},k=(e,{scrollToClose:t=!0,download:a=!0,fullscreen:o=!0,...s})=>import("photoswipe").then(({default:l})=>{let r=null;const i=e.map(n=>({html:y,element:n,msrc:n.src}));return e.forEach((n,u)=>{const c=()=>{r?.destroy(),r=new l({preloaderDelay:0,showHideAnimationType:"zoom",...s,dataSource:i,index:u,...t?{closeOnVerticalDrag:!0,wheelToZoom:!1}:{}}),b(r,{download:a,fullscreen:o}),r.addFilter("thumbEl",()=>n),r.addFilter("placeholderSrc",()=>n.src),r.init()};n.getAttribute("photo-swipe")||(n.style.cursor="zoom-in",n.addEventListener("click",()=>{c()}),n.addEventListener("keypress",({key:d})=>{d==="Enter"&&c()}),n.setAttribute("photo-swipe","")),p(n).then(d=>{i.splice(u,1,d),r?.refreshSlideContent(u)})}),t?D("wheel",()=>{r?.close()}):()=>{}}),B=({selector:e,locales:t,delay:a=500,download:o=!0,fullscreen:s=!0,scrollToClose:l=!0})=>{const r=f(),i=x(t),n=H(),u=M();let c=null;const d=()=>{const{photoSwipe:h}=u.value;h!==!1&&N().then(()=>E(a)).then(async()=>{const C=v(h)?h:e;c=await k(S(C),{...r.value,...i.value,download:o,fullscreen:s,scrollToClose:l})})};P(()=>{d(),w(()=>[n.value.path,r.value],()=>{c?.(),d()})}),L(()=>{c?.()})};export{y as L,b as a,f as b,S as c,F as d,p as e,V as g,O as i,k as r,B as u};
//# sourceMappingURL=usePhotoSwipe-CnOVn-_z.js.map
