import{katex as f}from"@mdit/plugin-katex-slim";import{createMathjaxInstance as g,mathjax as k}from"@mdit/plugin-mathjax-slim";import{ensureEndingSlash as $,Logger as y,getRealPath as w,getInstalledStatus as d,addCustomElement as C}from"@vuepress/helper";import{getDirname as M,path as v,logger as p,colors as u}from"vuepress/utils";const I=M(import.meta.url),h=$(v.resolve(I,"../client")),c="@vuepress/plugin-markdown-math";new y(c);const{url:E}=import.meta,F=async(e,r,m)=>{let o="";return r==="katex"?o+=`import "${w("katex/dist/katex.min.css",E)}";
import "${h}styles/katex.css";
${m.copy?`import { useKatexCopy } from "${h}composables/useKatexCopy.js";

export default {
  setup: () => {
    useKatexCopy();
  }
};
`:""}`:o+=`import './mathjax.css';
`,e.writeTemp("markdown-math/config.js",o)},L=`mjx-container {
  overflow: auto hidden;
}
`,P=async(e,r)=>{await e.writeTemp("markdown-math/mathjax.css",`${r.outputStyle()}
${L}`)},N=({type:e,...r}={})=>{const m=d("mathjax-full",import.meta.url),o=d("katex",import.meta.url),n=e==="katex"&&o?"katex":e==="mathjax"&&m||m?"mathjax":o?"katex":null;if(!n||e&&n!==e){const t={katex:"katex",mathjax:"mathjax-full"};return p.error(n?`type is "${e}", but "${t[e]}" is not installed`:"No math renderer found, please install mathjax-full or katex"),{name:c}}const l=n==="mathjax"?g({...r,transformer:t=>t.replace(/^<mjx-container/,"<mjx-container v-pre")}):null;return{name:c,extendsBundlerOptions:(t,a)=>{n==="mathjax"&&C(t,a,/^mjx-/)},extendsMarkdown:t=>{n==="mathjax"?(t.use(k,l),t.use(a=>{const x=a.render.bind(a);a.render=(i,s)=>{const j=x(i,s);return l.reset(),j}})):t.use(f,{logger:(a,x,i,{filePathRelative:s})=>{a!=="newLineInDisplayMode"&&(a==="unicodeTextInMathMode"?p.warn(`Found unicode character ${i.text} inside tex${s?` in ${u.cyan(s)}`:""}. You should use ${u.magenta(`\\text{${i.text}}`)}`):p.warn(`${x}.${s?`
Found in ${u.cyan(s)}`:""}`))},macros:{},...r,transformer:a=>a.replace(/^(<[a-z]+ )/g,"$1v-pre ")})},onPrepared:async t=>{n==="mathjax"&&await P(t,l)},clientConfigFile:t=>F(t,n,r)}};export{N as markdownMathPlugin};
//# sourceMappingURL=index.js.map
