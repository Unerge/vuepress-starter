import{isString as v,LoadingIcon as k,wait as c}from"@vuepress/helper/client";import{defineComponent as g,ref as y,shallowRef as w,computed as C,onMounted as h,watch as o,onUnmounted as D,h as r,nextTick as s}from"vue";import{usePageData as M,useSiteData as A}from"vuepress/client";import"artalk/dist/Artalk.css";import{u as B}from"../index-Ct80hyY4.js";var S=g({name:"ArtalkComment",props:{identifier:{type:String,required:!0},darkmode:Boolean},setup(a){const t=B(),l=M(),n=A(),d=y(!1),u=w();let e=null;const m=C(()=>v(t.value.server)),p=async()=>{const[{default:i}]=await Promise.all([import("artalk/dist/Artalk.mjs"),c(t.value.delay??800)]);d.value=!0,await s(),e=i.init({useBackendConf:!1,site:n.value.title,pageTitle:l.value.title,...t.value,el:u.value,pageKey:a.identifier,darkMode:a.darkmode}),t.value.useBackendConf&&e.on("mounted",()=>{e.setDarkMode(a.darkmode)})},f=()=>{e.update({site:n.value.title,pageTitle:l.value.title,pageKey:a.identifier}),e.reload()};return h(()=>{o(()=>t.value,()=>{e?.destroy(),p()},{immediate:!0}),o(()=>a.identifier,()=>{e&&s().then(()=>{f()})}),o(()=>a.darkmode,i=>{e?.setDarkMode(i)})}),D(()=>{e?.destroy()}),()=>m.value?r("div",{class:"artalk-wrapper"},[d.value?null:r(k),r("div",{ref:u})]):null}});export{S as default};
//# sourceMappingURL=ArtalkComment.js.map
