{"version":3,"file":"TwikooComment.js","sources":["../../../src/client/components/TwikooComment.ts"],"sourcesContent":["import { LoadingIcon, wait } from '@vuepress/helper/client'\nimport type { VNode } from 'vue'\nimport {\n  computed,\n  defineComponent,\n  h,\n  nextTick,\n  onMounted,\n  ref,\n  watch,\n} from 'vue'\nimport { usePageLang } from 'vuepress/client'\nimport { useTwikooOptions } from '../helpers/index.js'\n\nexport default defineComponent({\n  name: 'TwikooComment',\n\n  props: {\n    /**\n     * The path of the comment\n     */\n    identifier: {\n      type: String,\n      required: true,\n    },\n  },\n\n  setup(props) {\n    const twikooOptions = useTwikooOptions()\n    const lang = usePageLang()\n\n    const loaded = ref(false)\n\n    const enableTwikoo = computed(() => Boolean(twikooOptions.value.envId))\n\n    const initTwikoo = async (): Promise<void> => {\n      const [{ init }] = await Promise.all([\n        import(/* webpackChunkName: \"twikoo\" */ 'twikoo'),\n        wait(twikooOptions.value.delay ?? 800),\n      ])\n\n      loaded.value = true\n\n      await nextTick()\n\n      await init({\n        lang: lang.value === 'zh-CN' ? 'zh-CN' : 'en',\n        path: props.identifier,\n        ...twikooOptions.value,\n        el: '#twikoo-comment',\n      })\n    }\n\n    onMounted(() => {\n      watch(\n        () => [props.identifier, twikooOptions.value],\n        () => initTwikoo(),\n        { immediate: true },\n      )\n    })\n\n    return (): VNode | null =>\n      enableTwikoo.value\n        ? h('div', { id: 'comment', class: 'twikoo-wrapper' }, [\n            loaded.value ? null : h(LoadingIcon),\n            h('div', { id: 'twikoo-comment' }),\n          ])\n        : null\n  },\n})\n"],"names":["defineComponent","props","twikooOptions","useTwikooOptions","lang","usePageLang","loaded","ref","enableTwikoo","computed","initTwikoo","init","wait","nextTick","onMounted","watch","h","LoadingIcon"],"mappings":"mQAcA,IAAeA,EAAAA,EAAgB,CAC7B,KAAM,gBAEN,MAAO,CAIL,WAAY,CACV,KAAM,OACN,SAAU,EACZ,CACF,EAEA,MAAMC,EAAO,CACX,MAAMC,EAAgBC,IAChBC,EAAOC,IAEPC,EAASC,EAAI,EAAK,EAElBC,EAAeC,EAAS,IAAM,CAAA,CAAQP,EAAc,MAAM,KAAM,EAEhEQ,EAAa,SAA2B,CAC5C,KAAM,CAAC,CAAE,KAAAC,CAAK,CAAC,EAAI,MAAM,QAAQ,IAAI,CACnC,OAAwC,QAAQ,EAChDC,EAAKV,EAAc,MAAM,OAAS,GAAG,CACvC,CAAC,EAEDI,EAAO,MAAQ,GAEf,MAAMO,IAEN,MAAMF,EAAK,CACT,KAAMP,EAAK,QAAU,QAAU,QAAU,KACzC,KAAMH,EAAM,WACZ,GAAGC,EAAc,MACjB,GAAI,iBACN,CAAC,CACH,EAEA,OAAAY,EAAU,IAAM,CACdC,EACE,IAAM,CAACd,EAAM,WAAYC,EAAc,KAAK,EAC5C,IAAMQ,EAAW,EACjB,CAAE,UAAW,EAAK,CACpB,CACF,CAAC,EAEM,IACLF,EAAa,MACTQ,EAAE,MAAO,CAAE,GAAI,UAAW,MAAO,gBAAiB,EAAG,CACnDV,EAAO,MAAQ,KAAOU,EAAEC,CAAW,EACnCD,EAAE,MAAO,CAAE,GAAI,gBAAiB,CAAC,CACnC,CAAC,EACD,IACR,CACF,CAAC"}