{"version":3,"file":"KotlinPlayground.js","sources":["../../../src/client/components/KotlinPlayground.ts"],"sourcesContent":["import { decodeData } from \"@vuepress/helper/client\";\nimport { useMutationObserver } from \"@vueuse/core\";\nimport type { VNode } from \"vue\";\nimport {\n  computed,\n  defineComponent,\n  h,\n  nextTick,\n  onMounted,\n  ref,\n  shallowRef,\n  watch,\n} from \"vue\";\n\nimport { getDarkmodeStatus } from \"../utils/index.js\";\n\nimport \"../styles/kotlin-playground.scss\";\n\nexport default defineComponent({\n  name: \"KotlinPlayground\",\n\n  props: {\n    /**\n     * Playground title\n     *\n     * 演示标题\n     */\n    title: {\n      type: String,\n      default: \"\",\n    },\n\n    /**\n     * Playground file data\n     *\n     * 演示文件数据\n     */\n    files: { type: String, required: true },\n\n    /**\n     * Playground settings\n     *\n     * 演示设置\n     */\n    settings: { type: String, default: \"{}\" },\n  },\n\n  setup(props) {\n    const isDarkmode = ref(false);\n\n    const kotlinPlayground = shallowRef<HTMLDivElement>();\n\n    const files = computed(\n      () => JSON.parse(decodeData(props.files)) as string[],\n    );\n\n    const settings = computed(() => ({\n      theme: isDarkmode.value ? \"darcula\" : \"default\",\n      ...(JSON.parse(decodeURIComponent(props.settings)) as Record<\n        string,\n        string\n      >),\n    }));\n\n    const renderPlayground = async (): Promise<void> => {\n      const { default: playground } = await import(\n        /* webpackChunkName: \"kotlin-playground\" */ \"kotlin-playground\"\n      );\n\n      playground(kotlinPlayground.value!);\n    };\n\n    onMounted(() => {\n      isDarkmode.value = getDarkmodeStatus();\n\n      // Watch darkmode change\n      useMutationObserver(\n        document.documentElement,\n        () => {\n          isDarkmode.value = getDarkmodeStatus();\n        },\n        {\n          attributeFilter: [\"class\", \"data-theme\"],\n          attributes: true,\n        },\n      );\n\n      watch(isDarkmode, () => nextTick().then(() => renderPlayground()), {\n        immediate: true,\n      });\n    });\n\n    return (): VNode =>\n      h(\"div\", { class: \"kotlin-playground-wrapper\" }, [\n        props.title\n          ? h(\"div\", { class: \"header\" }, decodeURIComponent(props.title))\n          : null,\n        h(\n          \"div\",\n          {\n            class: \"kotlin-playground-container\",\n            key: isDarkmode.value ? \"dark\" : \"light\",\n          },\n\n          h(\n            \"div\",\n            {\n              class: \"kotlin-playground\",\n              ref: kotlinPlayground,\n              ...settings.value,\n            },\n            [\n              h(\"pre\", files.value[0]),\n              // Hidden dependency\n              files.value.length > 1\n                ? files.value.map((content, index) =>\n                    index === 0\n                      ? null\n                      : h(\n                          \"textarea\",\n                          { class: \"hidden-dependency\", readonly: \"\" },\n                          content,\n                        ),\n                  )\n                : null,\n            ],\n          ),\n        ),\n      ]);\n  },\n});\n"],"names":["KotlinPlayground","defineComponent","props","isDarkmode","ref","kotlinPlayground","shallowRef","files","computed","decodeData","settings","renderPlayground","playground","onMounted","getDarkmodeStatus","useMutationObserver","watch","nextTick","h","content","index"],"mappings":"kUAkBA,IAAAA,EAAeC,EAAgB,CAC7B,KAAM,mBAEN,MAAO,CAML,MAAO,CACL,KAAM,OACN,QAAS,EACX,EAOA,MAAO,CAAE,KAAM,OAAQ,SAAU,EAAK,EAOtC,SAAU,CAAE,KAAM,OAAQ,QAAS,IAAK,CAC1C,EAEA,MAAMC,EAAO,CACX,MAAMC,EAAaC,EAAI,EAAK,EAEtBC,EAAmBC,EAA2B,EAE9CC,EAAQC,EACZ,IAAM,KAAK,MAAMC,EAAWP,EAAM,KAAK,CAAC,CAC1C,EAEMQ,EAAWF,EAAS,KAAO,CAC/B,MAAOL,EAAW,MAAQ,UAAY,UACtC,GAAI,KAAK,MAAM,mBAAmBD,EAAM,QAAQ,CAAC,CAInD,EAAE,EAEIS,EAAmB,SAA2B,CAClD,KAAM,CAAE,QAASC,CAAW,EAAI,KAAM,QACQ,mBAC9C,EAEAA,EAAWP,EAAiB,KAAM,CACpC,EAEA,OAAAQ,EAAU,IAAM,CACdV,EAAW,MAAQW,EAAkB,EAGrCC,EACE,SAAS,gBACT,IAAM,CACJZ,EAAW,MAAQW,EACrB,CAAA,EACA,CACE,gBAAiB,CAAC,QAAS,YAAY,EACvC,WAAY,EACd,CACF,EAEAE,EAAMb,EAAY,IAAMc,EAAW,EAAA,KAAK,IAAMN,EAAAA,CAAkB,EAAG,CACjE,UAAW,EACb,CAAC,CACH,CAAC,EAEM,IACLO,EAAE,MAAO,CAAE,MAAO,2BAA4B,EAAG,CAC/ChB,EAAM,MACFgB,EAAE,MAAO,CAAE,MAAO,QAAS,EAAG,mBAAmBhB,EAAM,KAAK,CAAC,EAC7D,KACJgB,EACE,MACA,CACE,MAAO,8BACP,IAAKf,EAAW,MAAQ,OAAS,OACnC,EAEAe,EACE,MACA,CACE,MAAO,oBACP,IAAKb,EACL,GAAGK,EAAS,KACd,EACA,CACEQ,EAAE,MAAOX,EAAM,MAAM,CAAC,CAAC,EAEvBA,EAAM,MAAM,OAAS,EACjBA,EAAM,MAAM,IAAI,CAACY,EAASC,IACxBA,IAAU,EACN,KACAF,EACE,WACA,CAAE,MAAO,oBAAqB,SAAU,EAAG,EAC3CC,CACF,CACN,EACA,IACN,CACF,CACF,CACF,CAAC,CACL,CACF,CAAC"}