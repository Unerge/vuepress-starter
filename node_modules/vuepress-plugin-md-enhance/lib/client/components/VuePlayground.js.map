{"version":3,"file":"VuePlayground.js","sources":["../../../src/client/components/VuePlayground.ts"],"sourcesContent":["import type { Repl, ReplProps, Store } from \"@vue/repl\";\nimport { LoadingIcon, deepAssign } from \"@vuepress/helper/client\";\nimport type { Component, VNode } from \"vue\";\nimport {\n  computed,\n  defineComponent,\n  h,\n  onMounted,\n  ref,\n  shallowRef,\n  version,\n} from \"vue\";\n\nimport { useVuePlaygroundConfig } from \"../helpers/index.js\";\nimport type { VuePlaygroundOptions } from \"../typings/index.js\";\n\nimport \"@vue/repl/style.css\";\nimport \"../styles/vue-playground.scss\";\n\ndeclare const VUE_PLAYGROUND_MONACO: boolean;\n\nconst getVuePlaygroundSettings = (settings: string): VuePlaygroundOptions =>\n  JSON.parse(decodeURIComponent(settings)) as VuePlaygroundOptions;\n\nexport default defineComponent({\n  name: \"VuePlayground\",\n\n  props: {\n    /**\n     * Playground title\n     *\n     * 演示标题\n     */\n    title: {\n      type: String,\n      default: \"\",\n    },\n\n    /**\n     * Playground file data\n     *\n     * 演示文件数据\n     */\n    files: { type: String, required: true },\n\n    /**\n     * Playground settings\n     *\n     * 演示设置\n     */\n    settings: { type: String, default: \"{}\" },\n  },\n\n  setup(props) {\n    const {\n      vueVersion = version,\n      vueRuntimeDevUrl = `https://unpkg.com/@vue/runtime-dom@${vueVersion}/dist/runtime-dom.esm-browser.js`,\n      vueRuntimeProdUrl = `https://unpkg.com/@vue/runtime-dom@${vueVersion}/dist/runtime-dom.esm-browser.prod.js`,\n      vueServerRendererUrl = `https://unpkg.com/@vue/server-renderer@${vueVersion}/dist/server-renderer.esm-browser.js`,\n      ...vuePlaygroundOptions\n    } = useVuePlaygroundConfig();\n    const loading = ref(true);\n    const component = shallowRef<typeof Repl>();\n    const store = shallowRef<Store>();\n    const editor = shallowRef<Component>();\n\n    const playgroundOptions = computed(() =>\n      deepAssign(\n        {},\n        vuePlaygroundOptions,\n        getVuePlaygroundSettings(props.settings),\n      ),\n    );\n\n    const setupRepl = async (): Promise<void> => {\n      const [\n        { useStore, useVueImportMap, Repl },\n        { default: editorComponent },\n      ] = await Promise.all([\n        import(/* webpackChunkName: \"vue-repl\" */ \"@vue/repl\"),\n        VUE_PLAYGROUND_MONACO\n          ? import(/* webpackChunkName: \"vue-repl\" */ \"@vue/repl/monaco-editor\")\n          : import(\n              /* webpackChunkName: \"vue-repl\" */ \"@vue/repl/codemirror-editor\"\n            ),\n      ]);\n\n      component.value = Repl;\n      editor.value = editorComponent;\n\n      const { importMap, vueVersion } = useVueImportMap({\n        runtimeDev: vueRuntimeDevUrl,\n        runtimeProd: vueRuntimeProdUrl,\n        serverRenderer: vueServerRendererUrl,\n      });\n\n      store.value = useStore(\n        { builtinImportMap: importMap, vueVersion },\n        decodeURIComponent(props.files),\n      );\n    };\n\n    onMounted(async () => {\n      await setupRepl();\n      loading.value = false;\n    });\n\n    return (): (VNode | null)[] => [\n      h(\"div\", { class: \"vp-container vue-playground-wrapper\" }, [\n        props.title\n          ? h(\n              \"div\",\n              { class: \"vp-container-header\" },\n              h(\n                \"div\",\n                { class: \"vp-container-title\" },\n                decodeURIComponent(props.title),\n              ),\n            )\n          : null,\n        h(\"div\", { class: \"repl-container\" }, [\n          loading.value\n            ? h(LoadingIcon, { class: \"vue-preview-loading\", height: 192 })\n            : null,\n          component.value\n            ? h(component.value, {\n                ...playgroundOptions.value,\n                editor: editor.value,\n                store: store.value,\n              } as ReplProps)\n            : null,\n        ]),\n      ]),\n    ];\n  },\n});\n"],"names":["getVuePlaygroundSettings","settings","defineComponent","props","vueVersion","version","vueRuntimeDevUrl","vueRuntimeProdUrl","vueServerRendererUrl","vuePlaygroundOptions","useVuePlaygroundConfig","loading","ref","component","shallowRef","store","editor","playgroundOptions","computed","deepAssign","setupRepl","useStore","useVueImportMap","Repl","editorComponent","importMap","onMounted","h","LoadingIcon"],"mappings":"ySAqBA,MAAMA,EAA4BC,GAChC,KAAK,MAAM,mBAAmBA,CAAQ,CAAC,EAEzC,MAAeC,EAAgB,CAC7B,KAAM,gBAEN,MAAO,CAML,MAAO,CACL,KAAM,OACN,QAAS,EACX,EAOA,MAAO,CAAE,KAAM,OAAQ,SAAU,EAAK,EAOtC,SAAU,CAAE,KAAM,OAAQ,QAAS,IAAK,CAC1C,EAEA,MAAMC,EAAO,CACX,KAAM,CACJ,WAAAC,EAAaC,EACb,iBAAAC,EAAmB,sCAAsCF,CAAU,mCACnE,kBAAAG,EAAoB,sCAAsCH,CAAU,wCACpE,qBAAAI,EAAuB,0CAA0CJ,CAAU,uCAC3E,GAAGK,CACL,EAAIC,EAAAA,EACEC,EAAUC,EAAI,EAAI,EAClBC,EAAYC,IACZC,EAAQD,EAAkB,EAC1BE,EAASF,EAAAA,EAETG,EAAoBC,EAAS,IACjCC,EACE,CAAA,EACAV,EACAT,EAAyBG,EAAM,QAAQ,CACzC,CACF,EAEMiB,EAAY,SAA2B,CAC3C,KAAM,CACJ,CAAE,SAAAC,EAAU,gBAAAC,EAAiB,KAAAC,CAAK,EAClC,CAAE,QAASC,CAAgB,CAC7B,EAAI,MAAM,QAAQ,IAAI,CACpB,OAA0C,WAAW,EACrD,sBACI,OAA0C,yBAAyB,EACnE,OACqC,6BACrC,CACN,CAAC,EAEDX,EAAU,MAAQU,EAClBP,EAAO,MAAQQ,EAEf,KAAM,CAAE,UAAAC,EAAW,WAAArB,CAAW,EAAIkB,EAAgB,CAChD,WAAYhB,EACZ,YAAaC,EACb,eAAgBC,CAClB,CAAC,EAEDO,EAAM,MAAQM,EACZ,CAAE,iBAAkBI,EAAW,WAAArB,CAAW,EAC1C,mBAAmBD,EAAM,KAAK,CAChC,CACF,EAEA,OAAAuB,EAAU,SAAY,CACpB,MAAMN,EAAU,EAChBT,EAAQ,MAAQ,EAClB,CAAC,EAEM,IAAwB,CAC7BgB,EAAE,MAAO,CAAE,MAAO,qCAAsC,EAAG,CACzDxB,EAAM,MACFwB,EACE,MACA,CAAE,MAAO,qBAAsB,EAC/BA,EACE,MACA,CAAE,MAAO,oBAAqB,EAC9B,mBAAmBxB,EAAM,KAAK,CAChC,CACF,EACA,KACJwB,EAAE,MAAO,CAAE,MAAO,gBAAiB,EAAG,CACpChB,EAAQ,MACJgB,EAAEC,EAAa,CAAE,MAAO,sBAAuB,OAAQ,GAAI,CAAC,EAC5D,KACJf,EAAU,MACNc,EAAEd,EAAU,MAAO,CACjB,GAAGI,EAAkB,MACrB,OAAQD,EAAO,MACf,MAAOD,EAAM,KACf,CAAc,EACd,IACN,CAAC,CACH,CAAC,CACH,CACF,CACF,CAAC"}